{"version":3,"file":"pkgmall/page/mall/CommodityDetail.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtmBA;AACA;AACA;AAAA;AAGA;AAMA;AAGA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;AACA;AAAA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAGA;AAAA;AAAA;AAGA;;;;;;;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AACA;AACA;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1BA;AACA;AACA;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgmall/page/mall/CommodityDetail.tsx?7485","webpack://i_bizz_client/._src_form_RadioBoxes.tsx","webpack://i_bizz_client/._src_pkgmall_page_mall_CommodityDetail.tsx","webpack://i_bizz_client/._node_modules_@babel_runtime_helpers_esm_arrayWithHoles.js","webpack://i_bizz_client/._node_modules_@babel_runtime_helpers_esm_iterableToArrayLimit.js","webpack://i_bizz_client/._node_modules_@babel_runtime_helpers_esm_nonIterableRest.js","webpack://i_bizz_client/._node_modules_@babel_runtime_helpers_esm_slicedToArray.js"],"sourcesContent":["import _slicedToArray from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _dec, _class;\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { View } from '@tarojs/components';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport RowLayout from 'tsx/layout/RowLayout';\nimport ColumnLayout from 'tsx/layout/ColumnLayout';\nimport BrView from 'tsx/view/BrView';\nimport Level2View from 'tsx/view/Level2View';\nimport TabPane from 'tsx/view/TabPane';\nimport LegenImage from 'tsx/view/LegenImage';\nimport GeneralButton from 'tsx/form/GeneralButton';\nimport RadioBoxes from 'tsx/form/RadioBoxes';\nimport IntegerInput from 'tsx/form/IntegerInput';\nimport TextLabel from 'tsx/view/TextLabel';\nimport LinkTag from 'tsx/view/LinkTag';\n\n//import '@tarojs/taro/html5.css'\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nvar CommodityDetail = (_dec = inject('store'), _dec(_class = observer(_class = /*#__PURE__*/function (_React$Component) {\n  function CommodityDetail(props) {\n    var _this;\n    _classCallCheck(this, CommodityDetail);\n    _this = _callSuper(this, CommodityDetail, [props]);\n    _defineProperty(_this, \"label0\", {\n      memberId: '用户编号'\n    });\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"currUserId\", JsUtil.getAppItem('currUserId'));\n    _defineProperty(_this, \"operatorId\", JsUtil.getAppItem('currOperatorId'));\n    _defineProperty(_this, \"loadCommodity\", function (commodityId, mallType) {\n      var uri;\n      if (cnst.MALL_TYPE_G_B2B == mallType) {\n        uri = '/cm/pub/b2b/global/commodity/load/search';\n      } else if (cnst.MALL_TYPE_G_B2C == mallType) {\n        uri = '/cm/pub/b2c/global/commodity/load/search';\n      } else if (cnst.MALL_TYPE_R_B2B == mallType) {\n        uri = '/cm/pub/b2b/region/commodity/load/search';\n      } else if (cnst.MALL_TYPE_R_B2C == mallType) {\n        uri = '/cm/pub/b2c/region/commodity/load/search';\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var commodity = result.body;\n          var commoditySpecs = commodity.commoditySpecs,\n            bigImageUri = commodity.bigImageUri,\n            attributes = commodity.attributes;\n          var specMap = new Map();\n          var selectedSpecCombinationMap = new Map();\n          var _iterator = _createForOfIteratorHelper(commoditySpecs),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var spec = _step.value;\n              var specValues = JSON.parse(spec.specValues);\n              var _iterator2 = _createForOfIteratorHelper(specValues),\n                _step2;\n              try {\n                var _loop = function _loop() {\n                  var value = _step2.value;\n                  if (specMap.has(value.ni)) {\n                    var mapList = specMap.get(value.ni);\n                    if (!mapList.find(function (e) {\n                      return e.vi === value.vi;\n                    })) {\n                      specMap.get(value.ni).push(value);\n                    }\n                  } else {\n                    selectedSpecCombinationMap.set(value.ni, value.vi);\n                    specMap.set(value.ni, [value]);\n                  }\n                };\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  _loop();\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n          _this.setState({\n            commodity: commodity,\n            commodityName: commodity.commodityName,\n            bigImageUri: JSON.parse(bigImageUri),\n            attributes: JSON.parse(attributes).filter(function (e) {\n              return !!e;\n            }),\n            descriptions: commodity.descriptions,\n            specMap: specMap,\n            selectedSpecCombinationMap: selectedSpecCombinationMap\n          });\n          if (commodity.tradeType == cnst.TRADE_TYPE_GROUPON) {\n            _this.setRemainTime();\n          }\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, \"\".concat(uri, \"?id=\").concat(commodityId), succ, err);\n    });\n    _defineProperty(_this, \"onSpecOptionClick\", function (value) {\n      return function (event) {\n        var selectedSpecCombinationMap = _this.state.selectedSpecCombinationMap;\n        var nextSpecSelected = selectedSpecCombinationMap;\n        nextSpecSelected.set(value, event.detail.value);\n        _this.setState({\n          selectedSpecCombinationMap: nextSpecSelected\n        });\n      };\n    });\n    _defineProperty(_this, \"getCurrentSpecList\", function () {\n      var _this$state = _this.state,\n        specMap = _this$state.specMap,\n        selectedSpecCombinationMap = _this$state.selectedSpecCombinationMap;\n      var specNamesAndValuesToShow = [];\n      var _iterator3 = _createForOfIteratorHelper(specMap),\n        _step3;\n      try {\n        var _loop2 = function _loop2() {\n          var _step3$value = _slicedToArray(_step3.value, 2),\n            ni = _step3$value[0],\n            values = _step3$value[1];\n          var selectedSpecValueId = selectedSpecCombinationMap.get(ni);\n          var options = [];\n          values.map(function (item) {\n            return options.push({\n              label: item.v,\n              value: item.vi\n            });\n          });\n          specNamesAndValuesToShow.push(/*#__PURE__*/_jsxs(Level2View, {\n            children: [/*#__PURE__*/_jsxs(TextLabel, {\n              children: [values[0].n, \": \"]\n            }), /*#__PURE__*/_jsx(RadioBoxes, {\n              options: options,\n              value: selectedSpecValueId,\n              onChange: _this.onSpecOptionClick(ni)\n            })]\n          }, ni));\n        };\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          _loop2();\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n      return specNamesAndValuesToShow;\n    });\n    _defineProperty(_this, \"getSelectedSpecEntityFromcommoditySpecs\", function () {\n      if (!_this.state.commodity) return {};\n      var selectedSpecCombinationMap = _this.state.selectedSpecCombinationMap;\n      var commoditySpecs = _this.state.commodity.commoditySpecs;\n      return commoditySpecs.find(function (item) {\n        var currentSpecValues = JSON.parse(item.specValues);\n        var _iterator4 = _createForOfIteratorHelper(currentSpecValues),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var specValue = _step4.value;\n            if (selectedSpecCombinationMap.get(specValue.ni) !== specValue.vi) {\n              return false;\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n        return true;\n      });\n    });\n    _defineProperty(_this, \"handleQuantity\", function (inventories) {\n      return function (name, value) {\n        var quantity = value;\n        if (quantity < 1) quantity = 1;else if (quantity - inventories.inventories > 0) quantity = inventories.inventories;\n        _this.setState({\n          buyQuantity: quantity\n        });\n      };\n    });\n    _defineProperty(_this, \"initCartStore\", function () {\n      var orderStore = _this.props.store.orderStore;\n      if (_this.mallType == cnst.MALL_TYPE_G_B2B) {\n        orderStore.setMallType(cnst.MALL_TYPE_G_B2B);\n      } else if (_this.mallType == cnst.MALL_TYPE_G_B2C) {\n        orderStore.setMallType(cnst.MALL_TYPE_G_B2C);\n      } else if (_this.mallType == cnst.MALL_TYPE_R_B2B) {\n        orderStore.setMallType(cnst.MALL_TYPE_R_B2B);\n      } else if (_this.mallType == cnst.MALL_TYPE_R_B2C) {\n        orderStore.setMallType(cnst.MALL_TYPE_R_B2C);\n      }\n      orderStore.setB2bGlobalSpecIds([]);\n      orderStore.setB2bGlobalQty([]);\n      orderStore.setB2cGlobalSpecIds([]);\n      orderStore.setB2cGlobalQty([]);\n      orderStore.setB2bRegionSpecIds([]);\n      orderStore.setB2bRegionQty([]);\n      orderStore.setB2cRegionSpecIds([]);\n      orderStore.setB2cRegionQty([]);\n    });\n    _defineProperty(_this, \"buyStraightway\", function () {\n      //if (!JsUtil.checkLogin(this, '/od/pub/create')) return;\n      var _this$getSelectedSpec = _this.getSelectedSpecEntityFromcommoditySpecs(),\n        id = _this$getSelectedSpec.id;\n      var quantity = _this.state.buyQuantity;\n      var mallType = _this.state.commodity.mallType;\n      _this.initCartStore();\n\n      //mallType = (mallType == cnst.MALL_TYPE_G_B2B || mallType == cnst.MALL_TYPE_R_B2B) ? cnst.MALL_TYPE_G_B2B : cnst.MALL_TYPE_G_B2C;\n\n      var b2bGlobalQty = [];\n      var b2bGlobalSpecIds = [];\n      var b2cGlobalQty = [];\n      var b2cGlobalSpecIds = [];\n      var B2bRegionQty = [];\n      var B2bRegionSpecIds = [];\n      var b2cRegionQty = [];\n      var b2cRegionSpecIds = [];\n      var orderStore = _this.props.store.orderStore;\n      if (mallType == cnst.MALL_TYPE_G_B2B) {\n        b2bGlobalQty.push(quantity);\n        b2bGlobalSpecIds.push(id);\n        orderStore.setB2bGlobalSpecIds(b2bGlobalSpecIds);\n        orderStore.setB2bGlobalQty(b2bGlobalQty);\n        orderStore.setMallType(cnst.MALL_TYPE_G_B2B);\n      } else if (mallType == cnst.MALL_TYPE_G_B2C) {\n        b2cGlobalQty.push(quantity);\n        b2cGlobalSpecIds.push(id);\n        orderStore.setB2cGlobalSpecIds(b2cGlobalSpecIds);\n        orderStore.setB2cGlobalQty(b2cGlobalQty);\n        orderStore.setMallType(cnst.MALL_TYPE_G_B2C);\n      } else if (mallType == cnst.MALL_TYPE_R_B2B) {\n        B2bRegionQty.push(quantity);\n        B2bRegionSpecIds.push(id);\n        orderStore.setB2bRegionSpecIds(B2bRegionSpecIds);\n        orderStore.setB2bRegionQty(B2bRegionQty);\n        orderStore.setMallType(cnst.MALL_TYPE_R_B2B);\n      } else if (mallType == cnst.MALL_TYPE_R_B2C) {\n        b2cRegionQty.push(quantity);\n        b2cRegionSpecIds.push(id);\n        orderStore.setB2cRegionSpecIds(b2cRegionSpecIds);\n        orderStore.setB2cRegionQty(b2cRegionQty);\n        orderStore.setMallType(cnst.MALL_TYPE_R_B2C);\n      }\n      orderStore.setBuyImmediately(1);\n      JsUtil.go2Page(URI.ORDER_PLACE_ORDER);\n    });\n    _defineProperty(_this, \"add2Cart\", function () {\n      var _this$getSelectedSpec2 = _this.getSelectedSpecEntityFromcommoditySpecs(),\n        id = _this$getSelectedSpec2.id,\n        specName = _this$getSelectedSpec2.specName,\n        ourPrice = _this$getSelectedSpec2.ourPrice;\n      var param = {\n        commodityName: _this.state.commodity.commodityName,\n        commodityImageUri: JSON.parse(_this.state.commodity.bigImageUri)[0],\n        memberId: JsUtil.getAppItem('currUserId'),\n        quantity: _this.state.buyQuantity,\n        specId: id,\n        specName: specName,\n        specPrice: ourPrice,\n        supplierId: _this.state.commodity.supplierId,\n        supplierName: _this.state.commodity.supplierName\n      };\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          JsUtil.go2Tab(URI.MALL_HOME);\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      var mallType = _this.state.commodity.mallType;\n      var uri = '';\n      // b2b全国\n      if (mallType == cnst.MALL_TYPE_G_B2B) {\n        if (_this.currOrgType != cnst.ORG_TYPE_OP) {\n          JsUtil.handleMessage(_this, '只有运营中心能购买全国b2b商品');\n          return;\n        }\n        uri = '/cm/pub/b2b/global/cart/create';\n      }\n\n      // b2c全国\n      if (mallType == cnst.MALL_TYPE_G_B2C) {\n        uri = '/cm/pub/b2c/global/cart/create';\n      }\n\n      // b2b地方\n      if (mallType == cnst.MALL_TYPE_R_B2B) {\n        if (_this.currOrgType != cnst.ORG_TYPE_SS) {\n          JsUtil.handleMessage(_this, '只有社区店能购买地方b2b商品');\n          return;\n        }\n        uri = '/cm/pub/b2b/region/cart/create';\n      }\n\n      // b2c地方\n      if (mallType == cnst.MALL_TYPE_R_B2C) {\n        uri = '/cm/pub/b2c/region/cart/create';\n      }\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"changeTab\", function (value) {\n      _this.setState({\n        currTabIdx: value\n      });\n    });\n    _defineProperty(_this, \"share\", function () {\n      var memberId = JsUtil.getAppItem('currUserId');\n      if (!memberId) {\n        JsUtil.showMsgBox(_this, '请先登录。未登录的转发无效');\n      }\n    });\n    _defineProperty(_this, \"setRemainTime\", function () {\n      var onsaleTime = _this.state.commodity.onsaleTime;\n      var grouponDays = _this.state.commodity.grouponDays;\n      var remainingTime = Date.parse(onsaleTime) / 1000;\n      var currTime = Math.floor(Date.now() / 1000);\n      remainingTime = remainingTime + grouponDays * 24 * 60 * 60 - currTime;\n      if (remainingTime < 0) {\n        remainingTime = 0;\n        _this.setState({\n          timeFormat: '00:00:00',\n          disabled: true\n        });\n      } else {\n        var downloadTimer = setInterval(function () {\n          remainingTime -= 1;\n          if (remainingTime < 0) {\n            clearInterval(downloadTimer);\n          }\n          var hours = Math.floor(remainingTime / 3600);\n          var minutes = Math.floor(remainingTime % 3600 / 60);\n          var seconds = remainingTime % 60;\n          var timeFormat = \"\".concat(hours, \":\").concat(minutes, \":\").concat(seconds);\n          _this.setState({\n            timeFormat: timeFormat\n          });\n        }, 1000);\n      }\n    });\n    _defineProperty(_this, \"openChatting\", function () {\n      var commodity = _this.state.commodity;\n      JsUtil.go2Page(URI.MALL_CHATTING + '?directType=1' + '&mallType=' + commodity.mallType + '&orgId=' + commodity.supplierId + '&orgName=' + commodity.supplierName);\n    });\n    _defineProperty(_this, \"searchSupplierCommodity\", function () {\n      var commodity = _this.state.commodity;\n      JsUtil.go2Page(URI.MALL_COMMODITY_SEARCH_BOX + '?supplierId=' + commodity.supplierId);\n    });\n    _defineProperty(_this, \"go2ShopHome\", function (supplierId, supplierName) {\n      return function (event) {\n        JsUtil.go2Page(URI.MALL_SHOP_HOME + '?supplierId=' + supplierId + '&supplierName=' + supplierName);\n      };\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      buyQuantity: 1,\n      orgType: 0,\n      commodity: {},\n      commodityName: '',\n      bigImageUri: [],\n      specMap: new Map(),\n      selectedSpecCombinationMap: new Map(),\n      attributes: [],\n      descriptions: '',\n      currTabIdx: 0,\n      messages: {},\n      remainingTime: 0,\n      timeFormat: '',\n      disabled: false\n    };\n    return _this;\n  }\n  _inherits(CommodityDetail, _React$Component);\n  return _createClass(CommodityDetail, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var recommend = this.params;\n      var commodityId = recommend.commodityId;\n      var mallType = recommend.mallType;\n      if (!mallType) mallType = JsUtil.getAppItem('currMallType');\n      var weId = JsUtil.getAppItem('weId');\n      if (process.env.TARO_ENV == cnst.TARO_ENV_WEAPP) {\n        JsUtil.createWechat(this);\n        if (!weId && recommend.wePid) {\n          JsUtil.setAppItem('recommend', recommend);\n        }\n      }\n      if (this.currUserId && recommend.memberPid || weId && recommend.wePid) JsUtil.createRecommend(this, recommend);\n      this.loadCommodity(commodityId, mallType);\n      console.log('componentDidShow');\n    }\n  }, {\n    key: \"componentDidHide\",\n    value: function componentDidHide() {\n      console.log('CD componentDidHide');\n    }\n  }, {\n    key: \"onShareAppMessage\",\n    value: function onShareAppMessage(event) {\n      if (event.from === 'button') {\n        console.log(event.target);\n      } else {\n        console.log(event.webViewUrl);\n      }\n      var weId = JsUtil.getAppItem('weId');\n      if (!weId) {\n        JsUtil.showMsgBox(this, '获取不到微信编号，请重新打开微信小程序');\n        //return;\n      }\n      var memberId = JsUtil.getAppItem('currUserId');\n      if (!memberId) {\n        JsUtil.showMsgBox(this, '请先登录，未登录的转发无效');\n        //return;\n      }\n      var lastProvinceId = JsUtil.getAppItem('lastProvinceId') || '';\n      var uri = URI.MALL_COMMODITY_DETAIL + '?wePid=' + weId + '&memberPid=' + memberId + '&lastProvinceId=' + lastProvinceId + '&operatorId=' + this.operatorId + '&mallType=' + this.state.commodity.mallType + '&commodityId=' + this.state.commodity.id;\n      return {\n        title: this.state.commodityName,\n        path: uri,\n        imageUrl: JsUtil.IMAGE_PREFIX + this.state.bigImageUri[0],\n        success: function success(res) {\n          console.log('转发成功:' + JSON.stringify(res));\n        },\n        fail: function fail(res) {\n          console.log('转发失败:' + JSON.stringify(res));\n        }\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n        commodity = _this$state2.commodity,\n        buyQuantity = _this$state2.buyQuantity,\n        bigImageUri = _this$state2.bigImageUri,\n        descriptions = _this$state2.descriptions,\n        commodityName = _this$state2.commodityName,\n        attributes = _this$state2.attributes;\n      if (!commodityName) return null;\n      var imgPrefix = JsUtil.IMAGE_PREFIX;\n      var specNamesAndValuesToShow = this.getCurrentSpecList();\n      var _this$getSelectedSpec3 = this.getSelectedSpecEntityFromcommoditySpecs(),\n        inventories = _this$getSelectedSpec3.inventories,\n        marketPrice = _this$getSelectedSpec3.marketPrice,\n        ourPrice = _this$getSelectedSpec3.ourPrice;\n      var showPrice = '登录明细';\n      if (commodity) {\n        if (commodity.mallType == cnst.MALL_TYPE_G_B2C || commodity.mallType == cnst.MALL_TYPE_R_B2C) showPrice = JsUtil.currFormat(ourPrice);else if (commodity.mallType == cnst.MALL_TYPE_G_B2B && this.currOrgType == cnst.ORG_TYPE_OP) showPrice = JsUtil.currFormat(ourPrice);else if (commodity.mallType == cnst.MALL_TYPE_R_B2B && this.currOrgType == cnst.ORG_TYPE_SS) showPrice = JsUtil.currFormat(ourPrice);\n      }\n      var tabOptions = [{\n        idx: 0,\n        title: '商品介绍'\n      }, {\n        idx: 1,\n        title: '商品属性'\n      }, {\n        idx: 2,\n        title: '客户评价'\n      }];\n      var currTabIdx = this.state.currTabIdx;\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: '商品详情',\n        bottomLabel3: '立购',\n        bottomFunc3: this.buyStraightway,\n        bottomLabel4: '加车',\n        bottomFunc4: this.add2Cart,\n        bottomLabel5: '搜索',\n        bottomFunc5: this.searchSupplierCommodity,\n        bottomLabel6: '客服',\n        bottomFunc6: this.openChatting,\n        shareLabel: '分享',\n        shareFunc: this.share,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsxs(RowLayout, {\n          justifyContent: \"space-between\",\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n          children: [/*#__PURE__*/_jsx(LinkTag, {\n            onClick: this.go2ShopHome(commodity.supplierId, commodity.supplierName + '店'),\n            children: commodity.supplierName + '店'\n          }), /*#__PURE__*/_jsx(LinkTag, {\n            onClick: this.openChatting,\n            children: '联系客服'\n          })]\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(LegenImage, {\n          src: imgPrefix + bigImageUri[0],\n          width: cnst.NUM_WIDTH_MAIN,\n          height: -50\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: commodityName\n        }), /*#__PURE__*/_jsxs(TextLabel, {\n          children: [\"\\u5E02\\u573A\\u4EF7:\\xA0\\u300C\", JsUtil.currFormat(marketPrice), \"\\u300D\"]\n        }), /*#__PURE__*/_jsxs(RowLayout, {\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n          children: [/*#__PURE__*/_jsx(TextLabel, {\n            width: 64,\n            children: \"\\u552E\\u4EF7:\"\n          }), /*#__PURE__*/_jsx(TextLabel, {\n            color: \"red\",\n            children: showPrice\n          }), this.currUserId == '650976821923282945' && /*#__PURE__*/_jsx(GeneralButton, {\n            type: \"primary\",\n            openType: \"contact\",\n            size: \"mini\",\n            children: '联系客服'\n          })]\n        }), /*#__PURE__*/_jsxs(TextLabel, {\n          children: [\"\\u5E93\\u5B58:\\xA0\\xA0\\xA0\\xA0\\xA0\", inventories]\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 16\n        }), specNamesAndValuesToShow, /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE\n        }), /*#__PURE__*/_jsxs(RowLayout, {\n          justifyContent: \"flex-start\",\n          children: [/*#__PURE__*/_jsx(TextLabel, {\n            children: \"\\u8D2D\\u4E70\\u6570\\u91CF: \\xA0\\xA0\\xA0\"\n          }), /*#__PURE__*/_jsx(IntegerInput, {\n            name: 'quantity',\n            min: 1,\n            max: 999,\n            value: buyQuantity,\n            onChange: this.handleQuantity({\n              inventories: inventories\n            })\n          }), commodity && commodity.tradeType == cnst.TRADE_TYPE_GROUPON && /*#__PURE__*/_jsx(TextLabel, {\n            width: 100,\n            color: \"red\",\n            backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n            children: this.state.timeFormat\n          })]\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE\n        }), /*#__PURE__*/_jsxs(TabPane, {\n          currTabIdx: currTabIdx,\n          tabOptions: tabOptions,\n          onClick: this.changeTab,\n          children: [currTabIdx == 0 && /*#__PURE__*/_jsx(View, {\n            className: \"taro_html fullWidth\",\n            style: {\n              width: 'auto',\n              fontSize: 14\n            },\n            dangerouslySetInnerHTML: {\n              __html: descriptions\n            }\n          }), currTabIdx == 1 && /*#__PURE__*/_jsxs(ColumnLayout, {\n            children: [/*#__PURE__*/_jsxs(RowLayout, {\n              borderWidth: 1,\n              borderColor: [[255, 255, 255, 0.5], [25, 114, 210, 0.5], [25, 114, 210, 0.5], [25, 114, 210, 0.5]],\n              children: [/*#__PURE__*/_jsx(TextLabel, {\n                width: -30,\n                justifyContent: 'flex-end',\n                children: \"\\u5C5E\\u6027\\u540D\\u79F0\"\n              }), /*#__PURE__*/_jsx(TextLabel, {\n                width: -70,\n                children: \"\\xA0\\xA0\\xA0\\u5C5E\\u6027\\u503C\"\n              })]\n            }), attributes.map(function (row) {\n              return /*#__PURE__*/_jsxs(RowLayout, {\n                borderWidth: 1,\n                borderColor: [[255, 255, 255, 0.5], [25, 114, 210, 0.99], [25, 114, 210, 0.5], [25, 114, 210, 0.5]],\n                children: [/*#__PURE__*/_jsxs(TextLabel, {\n                  width: -30,\n                  justifyContent: 'flex-end',\n                  children: [row.n, \":\"]\n                }), /*#__PURE__*/_jsxs(TextLabel, {\n                  width: -70,\n                  color: \"gray\",\n                  children: [\"\\xA0\\xA0\", row.v]\n                })]\n              }, row.ni);\n            })]\n          }), currTabIdx == 2 && /*#__PURE__*/_jsx(ColumnLayout, {})]\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 36,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component)) || _class) || _class);\nexport default CommodityDetail;","import React from 'react'\r\nimport { styled } from '@linaria/react'\r\nimport { RadioGroup, Radio } from '@tarojs/components'\r\nimport TextLabel from 'tsx/view/TextLabel'\r\n\r\nconst RadioGroup0 = styled(RadioGroup)`\r\n   display: flex;\r\n   flex-direction: row;\r\n   justify-content: space-between;\r\n`\r\n\r\nconst Radio0 = styled(Radio)`\r\n   display: flex;\r\n   flex-direction: row;\r\n`\r\n\r\nclass RadioBoxes extends React.Component {\r\n  \r\n  render() {\r\n\tconst options = this.props.options;\r\n\tconst value = this.props.value;\r\n\t  \r\n    return (\r\n    <RadioGroup0 onChange={this.props.onChange}>\r\n    {options.map((option, idx) => {\r\n     const isChecked = option.value===value;\r\n     \r\n     return (\r\n      <Radio0 key={idx} value={option.value} checked={isChecked}\r\n       style={{fontSize: 14}}\r\n      >{option.label}\r\n      </Radio0>\r\n    )})}\r\n    </RadioGroup0>\r\n    )\r\n  }\r\n}\r\n\r\nexport default RadioBoxes\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgmall/page/mall/CommodityDetail!./CommodityDetail.tsx\"\nvar config = {};\n\ncomponent.enableShareAppMessage = true\nvar inst = Page(createPageConfig(component, 'pkgmall/page/mall/CommodityDetail', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };"],"names":[],"sourceRoot":""}