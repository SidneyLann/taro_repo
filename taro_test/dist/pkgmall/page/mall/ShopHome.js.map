{"version":3,"file":"pkgmall/page/mall/ShopHome.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgmall/page/mall/ShopHome.tsx?09a1","webpack://i_bizz_client/._src_pkgmall_page_mall_ShopHome.tsx"],"sourcesContent":["import _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _dec, _class;\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport FloorLayout from 'tsx/layout/FloorLayout';\nimport CardLayout from 'tsx/layout/CardLayout';\nimport BrView from 'tsx/view/BrView';\nimport LegenImage from 'tsx/view/LegenImage';\nimport LinkTag from 'tsx/view/LinkTag';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GridLayout from 'tsx/layout/GridLayout';\nimport CommodityLayout from 'tsx/layout/CommodityLayout';\nimport RowLayout from 'tsx/layout/RowLayout';\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nvar ShopHome = (_dec = inject('store'), _dec(_class = observer(_class = /*#__PURE__*/function (_React$Component) {\n  function ShopHome(props) {\n    var _this;\n    _classCallCheck(this, ShopHome);\n    _this = _callSuper(this, ShopHome, [props]);\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"searchFloorInfo\", function () {\n      var mallType = JsUtil.getAppItem('currMallType');\n      var currOperatorId = JsUtil.getAppItem('currOperatorId');\n      var supplierId = _this.params.supplierId;\n      if (!supplierId) supplierId = currOperatorId;\n      var param = JSON.stringify({\n        operatorId: currOperatorId,\n        supplierId: supplierId,\n        mallType: mallType\n      });\n      var uri = '/ml/pub/floor/search';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var floorRecords = result.body;\n          _this.setState({\n            floorRecords: floorRecords\n          });\n          var _mallType = JsUtil.getAppItem('currMallType');\n          var _supplierId = _this.params.supplierId;\n          floorRecords.map(function (item, idx) {\n            _this.searchCommoditybyType(_supplierId, _mallType, item.floorNumber);\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpPost(_this, uri, param, succ, err);\n    });\n    _defineProperty(_this, \"searchByKeyWord\", function (keyWord) {\n      return function (event) {\n        JsUtil.go2Page(URI.MALL_COMMODITY_LIST_KEYWORD + '?commodityName=' + keyWord);\n      };\n    });\n    _defineProperty(_this, \"searchMore\", function (showType2No) {\n      return function (event) {\n        JsUtil.go2Page(URI.MALL_SHOW_LIST_BY_TYPE + '?categoryId=' + cnst.SHOW_TYPE_FLOOR + '&category2Id=' + showType2No);\n      };\n    });\n    _defineProperty(_this, \"renderKeywords\", function (start, floor) {\n      var words = [];\n      for (var i = 1; i <= 8; i += 1) {\n        var key = start + i;\n        if (floor[key]) {\n          words.push(floor[key]);\n        }\n      }\n      if (words) {\n        return words.map(function (keyword) {\n          return /*#__PURE__*/_jsxs(LinkTag, {\n            onClick: _this.searchByKeyWord(keyword),\n            children: [keyword, \"\\u2002\"]\n          }, keyword);\n        });\n      }\n      return null;\n    });\n    _defineProperty(_this, \"searchCommoditybyType\", function (supplierId, mallType, floorNumber) {\n      var floorDetails = _this.state.floorDetails;\n      //if (floorDetails[floorNumber])\n      //\treturn;\n\n      var categoryId = cnst.SHOW_TYPE_FLOOR;\n      var category2Id = floorNumber;\n      var pageNo = 1;\n      var pageSize = cnst.COUNT_FLOOR_COMMODITY;\n      var operatorId = JsUtil.getAppItem('currOperatorId');\n      if (!supplierId) {\n        supplierId = operatorId;\n      }\n      var param = JSON.stringify({\n        operatorId: operatorId,\n        supplierId: supplierId,\n        mallType: mallType,\n        category: categoryId,\n        category2: category2Id,\n        pageNo: pageNo,\n        pageSize: pageSize\n      });\n      var uri = '/ml/pub/commodity/show/search';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var commodities = result.body;\n          floorDetails[floorNumber] = commodities;\n          _this.setState({\n            floorDetails: floorDetails\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpPost(_this, uri, param, succ, err);\n    });\n    _defineProperty(_this, \"go2CommodityDetail\", function (item, index) {\n      var commodityId = item.commodityId || item.id;\n      JsUtil.go2Page(URI.MALL_COMMODITY_DETAIL + '?commodityId=' + commodityId);\n    });\n    _defineProperty(_this, \"openChatting\", function () {\n      var supplierId = _this.params.supplierId;\n      var supplierName = _this.state.supplierName;\n      var mallType = JsUtil.getAppItem('currMallType');\n      JsUtil.go2Page(URI.MALL_CHATTING + '?directType=1' + '&mallType=' + mallType + '&orgId=' + supplierId + '&orgName=' + supplierName);\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      supplierName: '.',\n      floorRecords: [],\n      floorDetails: {},\n      messages: {}\n    };\n    return _this;\n  }\n  _inherits(ShopHome, _React$Component);\n  return _createClass(ShopHome, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log('ShopHome componentDidMount');\n      this.searchFloorInfo();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      console.log('ShopHome componentDidUpdate');\n    }\n  }, {\n    key: \"componentDidShow\",\n    value: function componentDidShow() {\n      console.log('ShopHome componentDidShow');\n      this.searchFloorInfo();\n    }\n  }, {\n    key: \"onShareAppMessage\",\n    value: function onShareAppMessage(event) {\n      if (event.from === 'button') {\n        console.log(event.target);\n      } else {\n        console.log(event.webViewUrl);\n      }\n      return {\n        title: '专注本地电商的家乡商城',\n        path: URI.MALL_HOME,\n        imageUrl: JsUtil.IMAGE_PREFIX + '/1599878051032/big11.png',\n        success: function success(res) {\n          console.log(res);\n          console.log('转发成功:' + JSON.stringify(res));\n        },\n        fail: function fail(res) {\n          console.log('转发失败:' + JSON.stringify(res));\n        }\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n      var floorRecords = this.state.floorRecords;\n      var floorDetails = this.state.floorDetails;\n      var mallType = JsUtil.getAppItem('currMallType');\n      var supplierId = this.params.supplierId;\n      var supplierName = JsUtil.decode(this.params.supplierName);\n      var imgPrefix = JsUtil.IMAGE_PREFIX;\n      var width = -90;\n      if (process.env.TARO_ENV === 'rn') {\n        width = -90;\n      } else {\n        width = -96;\n      }\n      return /*#__PURE__*/_jsxs(FloorLayout, {\n        that: this,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsxs(RowLayout, {\n          justifyContent: \"space-between\",\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n          children: [/*#__PURE__*/_jsx(TextLabel, {\n            children: supplierName\n          }), /*#__PURE__*/_jsx(LinkTag, {\n            onClick: this.openChatting,\n            children: '联系客服'\n          })]\n        }), floorRecords.map(function (floor, i) {\n          return /*#__PURE__*/_jsxs(CardLayout, {\n            title: floor.floorName,\n            thumb: imgPrefix + floor.smallImageUri,\n            children: [/*#__PURE__*/_jsx(RowLayout, {\n              justifyContent: \"flex-start\",\n              backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n              children: _this2.renderKeywords('keyword1', floor)\n            }), /*#__PURE__*/_jsx(LegenImage, {\n              src: imgPrefix + floor.bigImageUri,\n              width: cnst.NUM_WIDTH_MAIN,\n              height: -50\n            }), /*#__PURE__*/_jsx(GridLayout, {\n              data: floorDetails[floor.floorNumber],\n              columnSize: 2,\n              children: /*#__PURE__*/_jsx(CommodityLayout, {\n                onClick: _this2.go2CommodityDetail\n              })\n            }), /*#__PURE__*/_jsx(BrView, {\n              height: cnst.NUM_HEIGHT_LINE,\n              backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n            }), /*#__PURE__*/_jsxs(RowLayout, {\n              justifyContent: \"flex-end\",\n              backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE,\n              children: [_this2.renderKeywords('keyword2', floor), /*#__PURE__*/_jsx(LinkTag, {\n                onClick: _this2.searchMore(floor.floorNumber),\n                alignSelf: \"flex-end\",\n                children: \"\\u66F4\\u591A>\"\n              })]\n            }), /*#__PURE__*/_jsx(BrView, {\n              height: 36,\n              backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n            })]\n          }, floor.floorName + i);\n        })]\n      });\n    }\n  }]);\n}(React.Component)) || _class) || _class);\nexport default ShopHome;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgmall/page/mall/ShopHome!./ShopHome.tsx\"\nvar config = {};\n\ncomponent.enableShareAppMessage = true\nvar inst = Page(createPageConfig(component, 'pkgmall/page/mall/ShopHome', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}