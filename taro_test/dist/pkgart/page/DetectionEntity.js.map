{"version":3,"file":"pkgart/page/DetectionEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzLA;AACA;AACA;AAAA;AAGA;AAIA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAIA;AAAA;AAAA;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtBA;AAEA;AAEA;AAEA;AAEA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAGA;;;;;;;;;;;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgart/page/DetectionEntity.tsx?df33","webpack://i_bizz_client/._src_form_CustomProgress.tsx","webpack://i_bizz_client/._src_form_VideoPicker.tsx","webpack://i_bizz_client/._src_pkgart_page_DetectionEntity.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport React from 'react';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport BrView from 'tsx/view/BrView';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport VideoPicker from 'tsx/form/VideoPicker';\nimport LegenImage from 'tsx/view/LegenImage';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar DetectionEntity = /*#__PURE__*/function (_React$Component) {\n  function DetectionEntity(props) {\n    var _this;\n    _classCallCheck(this, DetectionEntity);\n    _this = _callSuper(this, DetectionEntity, [props]);\n    _defineProperty(_this, \"videoRef\", /*#__PURE__*/React.createRef());\n    _defineProperty(_this, \"labels0\", {\n      remark: \"备注\",\n      filePath: \"视频\"\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"currUserId\", JsUtil.getAppItem('currUserId'));\n    _defineProperty(_this, \"filePathChanged\", function (value) {\n      _this.setState({\n        filePath: value\n      });\n    });\n    _defineProperty(_this, \"onSubmit\", function () {\n      var _this$state = _this.state,\n        filePath = _this$state.filePath,\n        remark = _this$state.remark;\n      if (!filePath) {\n        JsUtil.showMsgBox(_this, '请选择要检测的视频');\n        return;\n      } else if (JsUtil.duplicatedSubmit(_this)) {\n        return;\n      }\n      var param = {\n        artType: _this.params.artType,\n        filePath: filePath,\n        remark: remark\n      };\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.discountSubmit(_this);\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpPost(_this, \"/ar/pub/on/detection/create\", JSON.stringify(param), succ, err);\n      JsUtil.countSubmit(_this);\n    });\n    _defineProperty(_this, \"onDetail\", function () {\n      var uri = '/ar/pub/on/detection/load/search?id=';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          _this.setState({\n            id: entity.id,\n            filePath: entity.filePath,\n            imageUri: entity.imageUri,\n            detectResult: entity.detectResult,\n            remark: entity.remark\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpGet(_this, uri + _this.params.id, succ, err);\n    });\n    _defineProperty(_this, \"onDetectResult\", function (value) {\n      var results = value.split(';');\n      return results.map(function (item) {\n        return /*#__PURE__*/_jsx(TextLabel, {\n          children: item\n        });\n      });\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onAddVideo\", function (event) {\n      var _this$videoRef$curren;\n      (_this$videoRef$curren = _this.videoRef.current) === null || _this$videoRef$curren === void 0 || _this$videoRef$curren.onAddVideo(event);\n    });\n    _defineProperty(_this, \"close\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      disabled: _this.params.mode == cnst.SHOW_MODE_VIEW,\n      id: '',\n      filePath: '',\n      imageUri: '',\n      detectResult: '',\n      remark: \"\",\n      submitCount: 0,\n      messages: {}\n    };\n    return _this;\n  }\n  _inherits(DetectionEntity, _React$Component);\n  return _createClass(DetectionEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.params.mode == cnst.SHOW_MODE_VIEW) this.onDetail();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n        disabled = _this$state2.disabled,\n        filePath = _this$state2.filePath,\n        imageUri = _this$state2.imageUri,\n        detectResult = _this$state2.detectResult,\n        remark = _this$state2.remark;\n      var labelSubmit = '提交';\n      var labelUpload = '上传';\n      if (this.params.mode == cnst.SHOW_MODE_VIEW) {\n        labelSubmit = '';\n        labelUpload = '';\n      }\n      var detectResults = '';\n      if (detectResult && disabled) detectResults = this.onDetectResult(detectResult);\n      var labelWidth = cnst.NUM_WIDTH_LABEL + 10;\n      var valueWidth = cnst.NUM_WIDTH_VALUE - 10;\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: '艺术视频检测',\n        bottomLabel4: '关闭',\n        bottomFunc4: this.close,\n        bottomLabel5: labelUpload,\n        bottomFunc5: this.onAddVideo,\n        bottomLabel6: labelSubmit,\n        bottomFunc6: this.onSubmit,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(VideoPicker, {\n          that: this,\n          ref: this.videoRef,\n          label: this.labels.filePath,\n          value: filePath,\n          onChange: this.filePathChanged,\n          disabled: disabled,\n          category: this.params.artType,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'remark',\n          label: this.labels.remark,\n          type: 'text',\n          value: remark,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), detectResults, disabled && /*#__PURE__*/_jsx(LegenImage, {\n          src: JsUtil.IMAGE_PREFIX + imageUri,\n          width: cnst.NUM_WIDTH_MAIN,\n          height: -50\n        })]\n      });\n    }\n  }]);\n}(React.Component);\nexport default DetectionEntity;","import React from 'react'\r\nimport { styled } from '@linaria/react'\r\nimport { Progress } from '@tarojs/components'\r\nimport TextLabel from 'tsx/view/TextLabel'\r\n\r\nconst Progress0 = styled(Progress)`\r\n   display: flex;\r\n   flex-direction: row;\r\n   justify-content: space-between;\r\n`\r\n\r\nclass CustomProgress extends React.Component {\r\n  \r\n  render() {\r\n    return (\r\n    <Progress percent={this.props.percent} showInfo>\r\n     \r\n    </Progress>\r\n    )\r\n  }\r\n}\r\n\r\nexport default CustomProgress\r\n","import React from 'react'\r\nimport Taro from '@tarojs/taro'\r\nimport JsUtil from 'tsx/common/JsUtil'\r\nimport cnst from 'tsx/common/Constant'\r\nimport ColumnLayout from 'tsx/layout/ColumnLayout';\r\nimport RowLayout from 'tsx/layout/RowLayout';\r\nimport TaroModal from 'tsx/component/TaroModal';\r\nimport TextLabel from 'tsx/view/TextLabel';\r\nimport GeneralInput from 'tsx/form/GeneralInput';\r\nimport GeneralButton from 'tsx/form/GeneralButton';\r\nimport CustomProgress from 'tsx/form/CustomProgress';\r\n\r\nclass VideoPicker extends React.Component {\r\n  state = {\r\n    isProgressOpen: false,\r\n    progressPercent: 0,\r\n    uploadTask: undefined\r\n  }\r\n  \r\n  onAddVideo = (event) =>{\r\n      JsUtil.onFileUpload(this.props.that, {fileType: 'v', count: 10, category: this.props.category, taskCallback: this.taskCallback}, this.onUploadSucc, this.onUploadFail, this.onOpenProgress);\r\n  }\r\n  \r\n  onUploadSucc = (result) => {\r\n      const fileUri = result.body;\r\n      this.props.onChange(fileUri);\r\n      this.setState({isProgressOpen: false});\r\n  }  \r\n  \r\n  taskCallback = (uploadTask) => {\r\n        this.setState({uploadTask: uploadTask});\r\n        uploadTask.onProgressUpdate(this.onProgress);\r\n  }  \r\n  \r\n  onProgress = (result) => {\r\n        this.setState({progressPercent: result.progress});\r\n  }\r\n  \r\n  onOpenProgress = () => {\r\n    this.setState({isProgressOpen: true});\r\n  }\r\n  \r\n  onUploadFail = (msg) => {\r\n\tconsole.log('onUploadFail msg:', msg);\r\n    JsUtil.showMsgBox(this.props.that, msg);\r\n    this.setState({isProgressOpen: false});\r\n  }\r\n  \r\n  onCancelUpload = () => {\r\n    this.setState({isProgressOpen: false});\r\n    this.state.uploadTask.abort();\r\n  }\r\n  \r\n  render() {\r\n      \r\n    return <ColumnLayout>\r\n      <GeneralInput name={'video'} label={this.props.label} type={'text'} value={this.props.value} disabled={true}  labelWidth={this.props.labelWidth} valueWidth={this.props.valueWidth} />\r\n      \r\n          <TaroModal isOpened={this.state.isProgressOpen} onClose={this.onClose} onCancel={this.onCancelUpload} confirmText='通过' cancelText='取消' >\r\n            <CustomProgress name={'progress'} percent={this.state.progressPercent} />\r\n          </TaroModal>\r\n    </ColumnLayout>\r\n  }\r\n}\r\n\r\nexport default VideoPicker\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgart/page/DetectionEntity!./DetectionEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgart/page/DetectionEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}