{"version":3,"file":"pkgfinance/page/finance/WithdrawEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgfinance/page/finance/WithdrawEntity.tsx?03ec","webpack://i_bizz_client/._src_pkgfinance_page_finance_WithdrawEntity.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _dec, _class;\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport validator from 'validator';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport RowLayout from 'tsx/layout/RowLayout';\nimport BrView from 'tsx/view/BrView';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport SimpleIcon from 'tsx/view/SimpleIcon';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar WithdrawEntity = (_dec = inject('store'), _dec(_class = observer(_class = /*#__PURE__*/function (_React$Component) {\n  function WithdrawEntity(props) {\n    var _this;\n    _classCallCheck(this, WithdrawEntity);\n    _this = _callSuper(this, WithdrawEntity, [props]);\n    _defineProperty(_this, \"labels0\", {\n      nickName: '微信昵称',\n      wxAccount: '微信账户',\n      balanceAmount: '账户余额',\n      withdrawAmount: '提现金额'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"validateFields\", void 0);\n    _defineProperty(_this, \"validateForm\", void 0);\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"opOptionType\", void 0);\n    _defineProperty(_this, \"currOrgType\", JsUtil.getAppItem('currOrgType'));\n    _defineProperty(_this, \"currUserId\", JsUtil.getAppItem('currUserId'));\n    _defineProperty(_this, \"loadAccEntity\", function () {\n      var uri = '/fn/pub/account/member/load/search?id=';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          _this.setState({\n            accEntity: entity,\n            wxAccount: entity.wxAccount\n          });\n          if (entity.wxAccount) {\n            var length = entity.wxAccount.length;\n            var wxAccount = entity.wxAccount;\n            if (length > 2000) {\n              wxAccount = wxAccount.substring(0, 6) + '......' + wxAccount.substring(length - 6);\n\n              //this.setState({wxAccount});\n            }\n            _this.setState({\n              wxAccount: wxAccount\n            });\n          } else if (!entity.wxAccount) {\n            JsUtil.showMsgBox(_this, '未找到微信支付账号，不能向微信转账。如您已有柏君商城账号，请打开柏君商城微信小程序，在注册页面输入登录名和密码，再点击关联按钮');\n          }\n          if (!entity.wxNickName || entity.wxNickName == '微信用户') {\n            JsUtil.showMsgBox(_this, '未找到微信昵称，可能您未同意我们收集你的微信昵称，不能确定您柏君商城账号所关联的微信账号是否正确。1. 如您已有柏君商城账号，请打开柏君商城微信小程序，在注册页面输入登录名和密码，再点击关联按钮。2. 或者您先试着提现一分钱，等您期望的微信账号收到款项后再发起大额提现，以确保资金不会转到不相关的微信账号。');\n          }\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpGet(_this, uri + _this.currUserId, succ, err);\n    });\n    _defineProperty(_this, \"showDetails\", function () {\n      var uri = '/fn/pub/withdraw/load/search?id=';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          var disabled = true;\n          if (_this.params.mode == cnst.SHOW_MODE_EDIT) {\n            disabled = false;\n          }\n          _this.setState({\n            entity: entity,\n            id: entity.id,\n            balanceAmount: entity.balanceAmount,\n            withdrawAmount: entity.withdrawAmount,\n            disabled: disabled\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, uri + _this.params.id, succ, err);\n    });\n    _defineProperty(_this, \"submit\", function () {\n      if (!_this.state.accEntity.wxAccount) {\n        JsUtil.showMsgBox(_this, '未找到微信支付账号，不能向微信转账。如您已有柏君商城账号，请打开柏君商城微信小程序，在注册页面输入登录名和密码，再点击关联按钮');\n        return;\n      }\n      var uri = '/fn/pub/withdraw/create';\n      var balanceAmount = _this.state.accEntity.cashBalance;\n      var withdrawAmount = _this.state.withdrawAmount;\n      if (withdrawAmount < cnst.NUM_FLOAT_0_01) {\n        JsUtil.showMsgBox(_this, '提现金额必须大于等于0.01元');\n        return;\n      }\n      if (withdrawAmount > balanceAmount) {\n        JsUtil.showMsgBox(_this, '提现金额不能大于账户余额');\n        return;\n      }\n      var param = _objectSpread(_objectSpread({}, _this.state.entity), {}, {\n        subjectType: _this.params.subjectType,\n        payType: cnst.PAY_TYPE_WX,\n        balanceAmount: withdrawAmount,\n        totalAmount: withdrawAmount\n      });\n      var msgs = _this.validateForm(validator, _this.labels0, param);\n      if (msgs != '') {\n        JsUtil.showMsgBox(_this, msgs);\n        return;\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"search\", function () {\n      var balanceAmount = _this.state.balanceAmount;\n      JsUtil.go2Page(URI.LOGISTICS_ADDRESS_LIST + '&mode=' + _this.params.mode + '&orgType=' + _this.params.orgType + '&memberId=' + memberId + '&depositDate=' + depositDate + '&regionId=' + regionId + '&depositAmount=' + depositAmount);\n    });\n    _defineProperty(_this, \"goBack\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onClose\", function (name) {\n      _this.setState(_defineProperty({}, name, false));\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      entity: {},\n      accEntity: {},\n      wxAccount: '',\n      withdrawAmount: 0,\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      disabled: _this.params.mode == cnst.SHOW_MODE_VIEW ? true : false,\n      errors: {\n        withdrawAmount: false\n      },\n      messages: {}\n    };\n    _this.init();\n    return _this;\n  }\n  _inherits(WithdrawEntity, _React$Component);\n  return _createClass(WithdrawEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.init();\n      this.loadAccEntity();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n      JsUtil.init(this, '/fn/pub/withdraw/init/search', 'withdraw').then(function (_ref) {\n        var validateFields = _ref.validateFields,\n          validateForm = _ref.validateForm;\n        _this2.validateFields = validateFields;\n        _this2.validateForm = validateForm;\n      });\n      if (cnst.SHOW_MODE_VIEW == this.state.mode || cnst.SHOW_MODE_EDIT == this.state.mode) {\n        this.showDetails();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var accEntity = this.state.accEntity;\n      var mode = this.state.mode;\n      var disabled = this.state.disabled;\n      var labelWidth = cnst.NUM_WIDTH_LABEL;\n      var valueWidth = cnst.NUM_WIDTH_VALUE;\n      var topNavBarTitle = '新增提现';\n      var commandLabel = '提交';\n      var command = this.submit;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        commandLabel = '关闭';\n        command = this.goBack;\n      } else if (mode == cnst.SHOW_MODE_LIST || mode == cnst.SHOW_MODE_LIST2) {\n        commandLabel = '查找';\n        command = this.search;\n      }\n      var required = '';\n      if (mode == cnst.SHOW_MODE_NEW || mode == cnst.SHOW_MODE_EDIT) required = '';\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel4: commandLabel,\n        bottomFunc4: command,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsxs(RowLayout, {\n          justifyContent: \"space-between\",\n          children: [/*#__PURE__*/_jsx(TextLabel, {\n            children: \"\\u5FAE\\u4FE1\\u5934\\u50CF\"\n          }), /*#__PURE__*/_jsx(SimpleIcon, {\n            value: JsUtil.IMAGE_PREFIX + this.state.accEntity.wxAvatar\n          })]\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'nickName',\n          label: required + this.labels.nickName,\n          type: 'digit',\n          value: this.state.accEntity.wxNickName,\n          error: this.state.errors.nickName,\n          onChange: this.onInputChanged,\n          disabled: true,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'wxAccount',\n          label: required + this.labels.wxAccount,\n          type: 'digit',\n          value: this.state.wxAccount,\n          error: this.state.errors.wxAccount,\n          onChange: this.onInputChanged,\n          disabled: true,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'balanceAmount',\n          label: required + this.labels.balanceAmount,\n          type: 'digit',\n          value: this.state.accEntity.cashBalance,\n          error: this.state.errors.balanceAmount,\n          disabled: true,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'withdrawAmount',\n          label: required + this.labels.withdrawAmount,\n          type: 'digit',\n          value: this.state.withdrawAmount,\n          error: this.state.errors.withdrawAmount,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 200,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component)) || _class) || _class);\nexport default WithdrawEntity;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgfinance/page/finance/WithdrawEntity!./WithdrawEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgfinance/page/finance/WithdrawEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}