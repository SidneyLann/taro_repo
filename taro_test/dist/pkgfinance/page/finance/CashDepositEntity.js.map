{"version":3,"file":"pkgfinance/page/finance/CashDepositEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAGA;AAEA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAGA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AAAA;AAAA;AAGA;;;;;;;;;;;;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgfinance/page/finance/CashDepositEntity.tsx?ec28","webpack://i_bizz_client/._src_component_MemberPicker.tsx","webpack://i_bizz_client/._src_pkgfinance_page_finance_CashDepositEntity.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _dec, _class;\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport validator from 'validator';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport BrView from 'tsx/view/BrView';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport DateInput from 'tsx/form/DateInput';\nimport MemberPicker from 'tsx/component/MemberPicker';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar CashDepositEntity = (_dec = inject('store'), _dec(_class = observer(_class = /*#__PURE__*/function (_React$Component) {\n  function CashDepositEntity(props) {\n    var _this;\n    _classCallCheck(this, CashDepositEntity);\n    _this = _callSuper(this, CashDepositEntity, [props]);\n    _defineProperty(_this, \"labels0\", {\n      subjectId: '主体编号',\n      memberId: '会员编号',\n      depositDate: '存款日期',\n      depositAmount: '存款金额',\n      interestRate: '利率'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"validateFields\", void 0);\n    _defineProperty(_this, \"validateForm\", void 0);\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"opOptionType\", void 0);\n    _defineProperty(_this, \"currOrgType\", JsUtil.getAppItem('currOrgType'));\n    _defineProperty(_this, \"showDetails\", function () {\n      var uri = '/fn/pub/deposit/load/search?id=';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          var disabled = true;\n          if (_this.params.mode == cnst.SHOW_MODE_EDIT) {\n            disabled = false;\n          }\n          _this.setState({\n            entity: entity,\n            id: entity.id,\n            memberId: entity.memberId,\n            depositDate: entity.depositDate,\n            depositAmount: entity.depositAmount,\n            interestRate: entity.interestRate,\n            disabled: disabled\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, uri + _this.params.id, succ, err);\n    });\n    _defineProperty(_this, \"submit\", function () {\n      var uri = '/fn/pub/deposit/update';\n      if (_this.state.mode == cnst.SHOW_MODE_NEW) uri = '/fn/pub/deposit/create';\n      var memberId = _this.state.memberId;\n      var depositDate = JsUtil.getDateTime(_this.state.depositDate);\n      var depositAmount = _this.state.depositAmount;\n      var interestRate = _this.state.interestRate;\n      var param = _objectSpread(_objectSpread({}, _this.state.entity), {}, {\n        memberId: memberId,\n        depositDate: depositDate,\n        depositAmount: depositAmount,\n        interestRate: interestRate\n      });\n      var msgs = _this.validateForm(validator, _this.labels0, param);\n      if (msgs != '') {\n        JsUtil.showMsgBox(_this, msgs);\n        return;\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"search\", function () {\n      var memberId = _this.state.memberId;\n      var depositDate = _this.state.depositDate;\n      var regionId = _this.state.regionId;\n      var depositAmount = _this.state.depositAmount;\n      JsUtil.go2Page(URI.LOGISTICS_ADDRESS_LIST + '&mode=' + _this.params.mode + '&orgType=' + _this.params.orgType + '&memberId=' + memberId + '&depositDate=' + depositDate + '&regionId=' + regionId + '&depositAmount=' + depositAmount);\n    });\n    _defineProperty(_this, \"goBack\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onMemberChange\", function (memberId) {\n      _this.setState({\n        memberId: memberId\n      });\n    });\n    _defineProperty(_this, \"onOpenMap\", function () {\n      _this.setState({\n        popupMap: true\n      });\n    });\n    _defineProperty(_this, \"onClose\", function (name) {\n      _this.setState(_defineProperty({}, name, false));\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      entity: {},\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      disabled: _this.params.mode == cnst.SHOW_MODE_VIEW ? true : false,\n      memberId: '',\n      depositDate: '',\n      errors: {\n        memberId: false,\n        depositDate: false,\n        depositAmount: false,\n        interestRate: false\n      },\n      depositAmount: '',\n      interestRate: '',\n      popupMap: false,\n      messages: {}\n    };\n    _this.init();\n    return _this;\n  }\n  _inherits(CashDepositEntity, _React$Component);\n  return _createClass(CashDepositEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      //this.opOptionType = this.getOpOptionType();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n      JsUtil.init(this, '/fn/pub/deposit/init/search', 'deliveryReceiptCashDeposit').then(function (_ref) {\n        var validateFields = _ref.validateFields,\n          validateForm = _ref.validateForm;\n        _this2.validateFields = validateFields;\n        _this2.validateForm = validateForm;\n      });\n      if (cnst.SHOW_MODE_VIEW == this.state.mode || cnst.SHOW_MODE_EDIT == this.state.mode) {\n        this.showDetails();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var mode = this.state.mode;\n      var disabled = this.state.disabled;\n      var labelWidth = cnst.NUM_WIDTH_LABEL;\n      var valueWidth = cnst.NUM_WIDTH_VALUE;\n      var topNavBarTitle = '新增存款';\n      var commandLabel = '提交';\n      var command = this.submit;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        commandLabel = '关闭';\n        command = this.goBack;\n      } else if (mode == cnst.SHOW_MODE_LIST || mode == cnst.SHOW_MODE_LIST2) {\n        commandLabel = '查找';\n        command = this.search;\n      }\n      var required = '';\n      if (mode == cnst.SHOW_MODE_NEW || mode == cnst.SHOW_MODE_EDIT) required = '';\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel4: commandLabel,\n        bottomFunc4: command,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(MemberPicker, {\n          name: 'memberId',\n          label: required + this.labels.memberId,\n          type: 'number',\n          value: this.state.memberId,\n          onChange: this.onMemberChange,\n          error: this.state.errors.memberId,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(DateInput, {\n          name: 'depositDate',\n          label: required + this.labels.depositDate,\n          type: 'date',\n          value: this.state.depositDate,\n          error: this.state.errors.depositDate,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'depositAmount',\n          label: required + this.labels.depositAmount,\n          type: 'digit',\n          value: this.state.depositAmount,\n          error: this.state.errors.depositAmount,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'interestRate',\n          label: required + this.labels.interestRate,\n          type: 'digit',\n          value: this.state.interestRate,\n          error: this.state.errors.interestRate,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 200,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component)) || _class) || _class);\nexport default CashDepositEntity;","import React from 'react'\r\nimport JsUtil from 'tsx/common/JsUtil'\r\nimport cnst from 'tsx/common/Constant'\r\nimport BrView from 'tsx/view/BrView'\r\nimport RowLayout from 'tsx/layout/RowLayout';\r\nimport TaroModal from 'tsx/component/TaroModal';\r\nimport TextLabel from 'tsx/view/TextLabel';\r\nimport GeneralInput from 'tsx/form/GeneralInput';\r\nimport CascadeBox from 'tsx/form/CascadeBox'\r\n\r\nclass MemberPicker extends React.Component {\r\n  state = {\r\n    entities: [],\r\n    loginName: '',\r\n    nickName: '',\r\n\tcheckedList: [],\r\n    isPopupOpen: false,\r\n    message: ''\r\n  }\r\n  \r\n  labels0 = {\r\n    loginName: '登录名称',\r\n    nickName: '会员昵称',\r\n    interestRate: '利率'\r\n  }\r\n\r\n  labels1 = { ...this.labels0 }\r\n  labels = { ...this.labels1 }\r\n  \r\n  onOpenPopup = () => {\r\n    if(this.props.disabled) return;\r\n    \r\n    this.setState({isPopupOpen: true});\r\n  }\r\n  \r\n  onClosePopup = () => {\r\n    this.setState({message: ''});\r\n    this.setState({ isPopupOpen: false })\r\n  }\r\n  \r\n  onConfirm = () => {\r\n        this.setState({message: ''});\r\n        \r\n\t\tconst checkedList = this.state.checkedList;\r\n\r\n\t\tif (checkedList.length == 0) {\r\n\t\t\tthis.setState({message: '请至少选中一项'});\r\n\t\t} else if (checkedList.length > 1) {\r\n\t\t\tthis.setState({message: '只能选择一条记录'});\r\n\t\t} else {\r\n            this.props.onChange(checkedList[0]);\r\n            \r\n            this.setState({isPopupOpen: false});\r\n        }\r\n  }\r\n\r\n  onInputChanged = (name, value) => {\r\n    this.setState({ [name]: value });\r\n  }\r\n  \r\n  onSearch = () => {\r\n    this.setState({checkedList: [], message: ''});\r\n    \r\n    const loginName = this.state.loginName;\r\n    const nickName = this.state.nickName;\r\n    \r\n    const uri = \"/mb/pub/search\";\r\n    \r\n    const params = {loginName, nickName, pageSize: 5, pageNo: 1}\r\n    \r\n    const succ = (result) => {\r\n      if (JsUtil.handleMessage(this, result, true)) {\r\n        this.setState({entities: result.body});\r\n      }\r\n    }\r\n\r\n    const err = (result) => {\r\n      JsUtil.handleMessage(this, result, true)\r\n    }\r\n\r\n    JsUtil.asyncHttpPost(this, uri, JSON.stringify(params), succ, err);\r\n  }\r\n\r\n  getOptions = (records) => {\r\n\t\tconst options = []\r\n\r\n\t\trecords.map((item, indx) => {\r\n\t\t\tconst desc = (\r\n\t\t\t\t<RowLayout justifyContent='space-between' width={cnst.NUM_WIDTH_MAIN+3} ><TextLabel>{item.loginName}</TextLabel><TextLabel>{item.nickName}</TextLabel></RowLayout>\r\n\t\t\t)\r\n\r\n\t\t\toptions.push({ value: item.id, label: item.detailCashDeposit, desc: desc })\r\n\t\t})\r\n\r\n\t\treturn options;\r\n  }\r\n\r\n  onCascadeBoxChanged = (name, selectedValues) => {\r\n    this.setState({ [name]: selectedValues })\r\n  }\r\n  \r\n  render() {        \r\n    const options = this.getOptions(this.state.entities);\r\n    const {disabled, checkedList, message} = this.state;\r\n    \r\n    return <RowLayout>\r\n      <GeneralInput name={this.props.name} label={this.props.label} type={'text'} value={this.props.value} disabled={true} labelWidth={this.props.labelWidth} valueWidth={this.props.valueWidth+5} />\r\n      <TextLabel onClick={this.onOpenPopup}>+</TextLabel>\r\n      \r\n          <TaroModal isOpened={this.state.isPopupOpen} onClose={this.onClosePopup} onConfirm={this.onConfirm} onCancel={this.onSearch} confirmText='确定' cancelText='搜索' justifyContent='flex-start' height={-100}>\r\n          <GeneralInput name={'loginName'} label={this.labels.loginName} type={'text'} value={this.state.loginName} onChange={this.onInputChanged} disabled={disabled}  labelWidth={this.props.labelWidth} valueWidth={this.props.valueWidth} />\r\n          <GeneralInput name={'nickName'} label={this.labels.nickName} type={'text'} value={this.state.nickName} onChange={this.onInputChanged} disabled={disabled}  labelWidth={this.props.labelWidth} valueWidth={this.props.valueWidth} />\r\n          <TextLabel color='red'>{message}</TextLabel>\r\n          \r\n          <BrView height={cnst.NUM_HEIGHT_LINE} backgroundColor={cnst.COLOR_BACKGROUND_NEAR_WHITE} />\r\n          <CascadeBox name='checkedList' \r\n\t\t\t\t\t\toptions={options}\r\n\t\t\t\t\t\tvalue={checkedList}\r\n\t\t\t\t\t\tonChange={this.onCascadeBoxChanged}\r\n\t                    width={cnst.NUM_WIDTH_MAIN}\r\n\t                    BrHeight={1}\r\n          >\r\n\t\t  </CascadeBox>\r\n          </TaroModal>\r\n    </RowLayout>\r\n  }\r\n}\r\n\r\nexport default MemberPicker\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgfinance/page/finance/CashDepositEntity!./CashDepositEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgfinance/page/finance/CashDepositEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}