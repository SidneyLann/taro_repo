{"version":3,"file":"pkglogistics/page/logistics/AddressEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkglogistics/page/logistics/AddressEntity.tsx?d41c","webpack://i_bizz_client/._src_pkglogistics_page_logistics_AddressEntity.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _dec, _class;\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport validator from 'validator';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport BrView from 'tsx/view/BrView';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport GeneralButton from 'tsx/form/GeneralButton';\nimport RegionField5 from 'tsx/component/RegionField5';\nimport TaroModal from 'tsx/component/TaroModal';\nimport MyMap from 'tsx/component/MyMap';\nimport OperatorSelect from 'tsx/component/OperatorSelect';\nimport callImage from 'img/p/loc-green.png';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar AddressEntity = (_dec = inject('store'), _dec(_class = observer(_class = /*#__PURE__*/function (_React$Component) {\n  function AddressEntity(props) {\n    var _this;\n    _classCallCheck(this, AddressEntity);\n    _this = _callSuper(this, AddressEntity, [props]);\n    _defineProperty(_this, \"labels0\", {\n      subjectId: '主体编号',\n      receiptPerson: '收货人',\n      receiptPhone: '联系电话',\n      regionId: '地区',\n      detailAddress: '详细地址',\n      latitude: '纬度',\n      longitude: '经度'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"markers\", [{\n      id: 0,\n      //id创建多个需要不同\n      iconPath: callImage,\n      //图标，需要在上面先import引入，否则展示不出来\n      longitude: _this.props.longitude,\n      latitude: _this.props.latitude,\n      title: \"标题\",\n      //标题，点击的时候展示\n      callout: {\n        //不适用自定义气泡的东西，在这里面写样式和内容\n        content: \"99+\",\n        textAlign: \"center\",\n        color: \"#fff\",\n        borderWidth: 0,\n        bgColor: 'rgba(0,0,0,0.2)',\n        //背景颜色，可使用rgba\n        anchorY: 30,\n        fontSize: 16,\n        display: \"ALWAYS\"\n      },\n      width: 40,\n      //icon大小\n      height: 50\n    }]);\n    _defineProperty(_this, \"validateFields\", void 0);\n    _defineProperty(_this, \"validateForm\", void 0);\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"opOptionType\", void 0);\n    _defineProperty(_this, \"currOrgType\", JsUtil.getAppItem('currOrgType'));\n    _defineProperty(_this, \"showDetails\", function () {\n      var uri = '/lg/pub/receipt/address/memb/load/search?id=';\n      if (_this.params.orgType != cnst.ORG_TYPE_MB) uri = '/lg/pub/receipt/address/organization/load/search?id=';\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          var regionName = entity.regionFullName;\n          var disabled = true;\n          if (_this.params.mode == cnst.SHOW_MODE_EDIT) {\n            disabled = false;\n            regionName = entity.regionId;\n          }\n          _this.setState({\n            entity: entity,\n            id: entity.id,\n            operatorId: entity.operatorId,\n            orgType: entity.orgType,\n            subjectId: entity.subjectId,\n            subjectName: entity.subjectName,\n            receiptPerson: entity.receiptPerson,\n            receiptPhone: entity.receiptPhone,\n            regionId: entity.regionId,\n            detailAddress: entity.detailAddress,\n            longitude: entity.longitude,\n            latitude: entity.latitude,\n            disabled: disabled\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, uri + _this.params.id, succ, err);\n    });\n    _defineProperty(_this, \"submit\", function () {\n      var operatorId = _this.state.operatorId;\n      var receiptPerson = _this.state.receiptPerson;\n      var receiptPhone = _this.state.receiptPhone;\n      var regionId = _this.state.regionId;\n      var detailAddress = _this.state.detailAddress;\n      var longitude = _this.state.longitude;\n      var latitude = _this.state.latitude;\n      if (!JsUtil.mobileFormat(_this, receiptPhone)) {\n        return;\n      }\n      var param = _objectSpread(_objectSpread({}, _this.state.entity), {}, {\n        receiptPerson: receiptPerson,\n        receiptPhone: receiptPhone,\n        regionId: regionId,\n        detailAddress: detailAddress,\n        longitude: longitude,\n        latitude: latitude\n      });\n      var uri = '/lg/pub/receipt/address/memb/create';\n      if (_this.state.mode == cnst.SHOW_MODE_NEW) {\n        param.orgType = _this.params.orgType;\n        param.operatorId = operatorId;\n        param.subjectName = JsUtil.getAppItem('currOrgName');\n        if (_this.params.orgType == cnst.ORG_TYPE_MB) {\n          param.subjectId = JsUtil.getAppItem('currUserId');\n        } else {\n          uri = '/lg/pub/receipt/address/organization/create';\n          param.subjectId = JsUtil.getAppItem('currOrgId');\n        }\n      } else if (_this.state.mode == cnst.SHOW_MODE_EDIT) {\n        if (_this.params.orgType == cnst.ORG_TYPE_MB) {\n          uri = '/lg/pub/receipt/address/memb/update';\n        } else {\n          uri = '/lg/pub/receipt/address/organization/update';\n        }\n      }\n      var msgs = _this.validateForm(validator, _this.labels0, param);\n      if (msgs != '') {\n        JsUtil.showMsgBox(_this, msgs);\n        return;\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"search\", function () {\n      var receiptPerson = _this.state.receiptPerson;\n      var receiptPhone = _this.state.receiptPhone;\n      var regionId = _this.state.regionId;\n      var detailAddress = _this.state.detailAddress;\n      JsUtil.go2Page(URI.LOGISTICS_ADDRESS_LIST + '&mode=' + _this.params.mode + '&orgType=' + _this.params.orgType + '&receiptPerson=' + receiptPerson + '&receiptPhone=' + receiptPhone + '&regionId=' + regionId + '&detailAddress=' + detailAddress);\n    });\n    _defineProperty(_this, \"goBack\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onOpenMap\", function () {\n      _this.setState({\n        popupMap: true\n      });\n    });\n    _defineProperty(_this, \"onRegionchange\", function (longitude, latitude) {\n      _this.setState({\n        longitude: longitude,\n        latitude: latitude\n      });\n    });\n    _defineProperty(_this, \"onClose\", function (name) {\n      _this.setState(_defineProperty({}, name, false));\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      entity: {},\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      disabled: false,\n      id: '',\n      operatorOptions: [],\n      operatorId: cnst.ID_HQ,\n      orgType: cnst.ORG_TYPE_MB,\n      subjectId: '',\n      subjectName: '',\n      receiptPerson: '',\n      receiptPhone: '',\n      regionId: _this.params.regionId || '',\n      errors: {\n        receiptPerson: false,\n        receiptPhone: false,\n        regionId: false,\n        detailAddress: false,\n        latitude: false,\n        longitude: false\n      },\n      city: [],\n      county: [],\n      town: [],\n      detailAddress: '',\n      longitude: '',\n      latitude: '',\n      popupMap: false,\n      messages: {}\n    };\n    _this.init();\n    return _this;\n  }\n  _inherits(AddressEntity, _React$Component);\n  return _createClass(AddressEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.opOptionType = this.getOpOptionType();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n      JsUtil.init(this, '/lg/pub/receipt/address/memb/init/search', 'deliveryReceiptAddress').then(function (_ref) {\n        var validateFields = _ref.validateFields,\n          validateForm = _ref.validateForm;\n        _this2.validateFields = validateFields;\n        _this2.validateForm = validateForm;\n      });\n      if (cnst.SHOW_MODE_VIEW == this.state.mode || cnst.SHOW_MODE_EDIT == this.state.mode) {\n        this.showDetails();\n      }\n    }\n  }, {\n    key: \"getOpOptionType\",\n    value: function getOpOptionType() {\n      var opOptionType = '';\n      if (this.params.orgType == cnst.ORG_TYPE_OP || this.params.orgType == cnst.ORG_TYPE_SP_G) {\n        opOptionType = cnst.OP_OPTION_TYPE_HQ;\n      } else if (this.params.orgType == cnst.ORG_TYPE_SP_R) {\n        opOptionType = cnst.OP_OPTION_TYPE_SUPPLIER;\n      } else if (this.params.orgType == cnst.ORG_TYPE_SS) {\n        opOptionType = cnst.OP_OPTION_TYPE_SERVICE_STATION;\n      } else if (this.params.orgType == cnst.ORG_TYPE_MB || this.params.orgType == cnst.ORG_TYPE_SP_B) {\n        opOptionType = cnst.OP_OPTION_TYPE_ALL;\n      }\n      return opOptionType;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      var mode = this.state.mode;\n      var disabled = this.state.disabled;\n      var labelWidth = cnst.NUM_WIDTH_LABEL;\n      var valueWidth = cnst.NUM_WIDTH_VALUE;\n      var topNavBarTitle = this.params.orgType == cnst.ORG_TYPE_MB ? '会员收货地址' : '机构收货地址';\n      var commandLabel = '提交';\n      var command = this.submit;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        commandLabel = '关闭';\n        command = this.goBack;\n      } else if (mode == cnst.SHOW_MODE_LIST || mode == cnst.SHOW_MODE_LIST2) {\n        commandLabel = '查找';\n        command = this.search;\n      }\n      var required = '';\n      if (mode == cnst.SHOW_MODE_NEW || mode == cnst.SHOW_MODE_EDIT) required = '*';\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel4: commandLabel,\n        bottomFunc4: command,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), this.params.orgType != cnst.ORG_TYPE_MB && /*#__PURE__*/_jsx(OperatorSelect, {\n          mode: cnst.SHOW_MODE_NEW,\n          optionType: this.opOptionType,\n          checkedId: '',\n          that: this,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'receiptPerson',\n          label: required + this.labels.receiptPerson,\n          type: 'text',\n          value: this.state.receiptPerson,\n          error: this.state.errors.receiptPerson,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'receiptPhone',\n          label: required + this.labels.receiptPhone,\n          type: 'phone',\n          value: this.state.receiptPhone,\n          error: this.state.errors.receiptPhone,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(RegionField5, {\n          mode: mode,\n          value: this.state.regionId,\n          that: this\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'detailAddress',\n          label: required + this.labels.detailAddress,\n          type: 'text',\n          value: this.state.detailAddress,\n          error: this.state.errors.detailAddress,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'longitude',\n          label: required + this.labels.longitude,\n          type: 'text',\n          value: this.state.longitude,\n          error: this.state.errors.longitude,\n          onChange: this.onInputChanged,\n          disabled: true,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'latitude',\n          label: required + this.labels.latitude,\n          type: 'text',\n          value: this.state.latitude,\n          error: this.state.errors.detailAddress,\n          onChange: this.onInputChanged,\n          disabled: true,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralButton, {\n          type: \"primary\",\n          size: \"mini\",\n          onClick: this.onOpenMap,\n          disabled: disabled,\n          children: '校正经纬度'\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_NEAR_WHITE\n        }), /*#__PURE__*/_jsx(TaroModal, {\n          isOpened: this.state.popupMap,\n          onClose: function onClose(e) {\n            return _this3.onClose('popupMap', e);\n          },\n          onConfirm: function onConfirm(e) {\n            return _this3.onClose('popupMap', e);\n          },\n          confirmText: \"\\u786E\\u5B9A\",\n          children: /*#__PURE__*/_jsx(MyMap, {\n            popup: true,\n            longitude: this.state.longitude,\n            latitude: this.state.latitude,\n            markers: this.markers,\n            onRegionchange: this.onRegionchange\n          })\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 200,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component)) || _class) || _class);\nexport default AddressEntity;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkglogistics/page/logistics/AddressEntity!./AddressEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkglogistics/page/logistics/AddressEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}