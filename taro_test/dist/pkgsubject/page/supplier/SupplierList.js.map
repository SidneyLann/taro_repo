{"version":3,"file":"pkgsubject/page/supplier/SupplierList.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgsubject/page/supplier/SupplierList.tsx?8292","webpack://i_bizz_client/._src_pkgsubject_page_supplier_SupplierList.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport React from 'react';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport per from 'tsx/common/Permissions';\nimport statuses from 'tsx/common/Statuses';\nimport URI from 'tsx/common/URI';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport RowLayout from 'tsx/layout/RowLayout';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport CascadeBox from 'tsx/form/CascadeBox';\nimport TaroModal from 'tsx/component/TaroModal';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar SupplierList = /*#__PURE__*/function (_React$Component) {\n  function SupplierList(props) {\n    var _this;\n    _classCallCheck(this, SupplierList);\n    _this = _callSuper(this, SupplierList, [props]);\n    _defineProperty(_this, \"labels0\", {\n      remark: '备注'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"errors\", {\n      remark: false\n    });\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"checkedAllList\", []);\n    _defineProperty(_this, \"currOrgId\", JsUtil.getAppItem('currOrgId'));\n    _defineProperty(_this, \"currOrgType\", JsUtil.getAppItem('currOrgType'));\n    _defineProperty(_this, \"currOrgName\", JsUtil.getAppItem('currOrgName'));\n    _defineProperty(_this, \"isSaleman\", false);\n    _defineProperty(_this, \"fetchSupplier\", function (_ref) {\n      var _ref$pageNo = _ref.pageNo,\n        pageNo = _ref$pageNo === void 0 ? 1 : _ref$pageNo,\n        _ref$status = _ref.status,\n        status = _ref$status === void 0 ? _this.params.status : _ref$status,\n        _ref$pageSize = _ref.pageSize,\n        pageSize = _ref$pageSize === void 0 ? cnst.PAGE_SIZE : _ref$pageSize,\n        _ref$supplierName = _ref.supplierName,\n        supplierName = _ref$supplierName === void 0 ? _this.state.supplierName : _ref$supplierName,\n        _ref$supplierType = _ref.supplierType,\n        supplierType = _ref$supplierType === void 0 ? _this.state.supplierType : _ref$supplierType,\n        _ref$detailAddress = _ref.detailAddress,\n        detailAddress = _ref$detailAddress === void 0 ? _this.state.detailAddress : _ref$detailAddress,\n        _ref$createBy = _ref.createBy,\n        createBy = _ref$createBy === void 0 ? _this.params.createBy : _ref$createBy,\n        _ref$createTime = _ref.createTime,\n        createTime = _ref$createTime === void 0 ? _this.state.createTime : _ref$createTime,\n        _ref$createTime2 = _ref.createTime2,\n        createTime2 = _ref$createTime2 === void 0 ? _this.state.createTime2 : _ref$createTime2;\n      var searchParam = {\n        pageNo: pageNo,\n        status: status,\n        pageSize: pageSize,\n        supplierName: supplierName,\n        supplierType: supplierType,\n        detailAddress: detailAddress,\n        createBy: createBy,\n        createTime: JsUtil.appendTime(createTime),\n        createTime2: JsUtil.appendTime(createTime2)\n      };\n      var uri = \"/sp/pub/region/search\";\n      if (_this.params.menuParam == cnst.MENU_HQ_G_B2C) uri = \"/sp/pub/global/search\";else if (cnst.ORG_TYPE_OP == _this.currOrgType) {\n        uri = \"/sp/pub/saleman/search\";\n        searchParam.status = statuses.supplier.STATUS_NEW;\n      } else if (_this.params.createBy) {\n        uri = \"/sp/pub/application/search\";\n      }\n      searchParam.operatorId = _this.params.operatorId;\n      if (_this.currOrgType == cnst.ORG_TYPE_SP_G || _this.currOrgType == cnst.ORG_TYPE_SP_R || _this.currOrgType == cnst.ORG_TYPE_SP_B) searchParam.id = _this.currOrgId;\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var data = result.body;\n          var checkedList = [];\n          data.map(function (item, idx) {\n            checkedList.push(item.id);\n          });\n          _this.checkedAllList = [].concat(checkedList);\n          _this.setState({\n            suppliers: data,\n            totalRecords: result.totalRecords\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(searchParam), succ, err);\n    });\n    _defineProperty(_this, \"detailFunc\", function (mode) {\n      return function (event) {\n        var checkedList = _this.state.checkedList;\n        if (checkedList.length == 0) {\n          JsUtil.showMsgBox(_this, '请至少选中一项');\n        } else if (checkedList.length > 1) {\n          JsUtil.showMsgBox(_this, '只能选择一条记录');\n        } else {\n          JsUtil.go2Page(URI.SUPPLIER_SUPPLIER_ENTITY + '?mode=' + mode + '&id=' + checkedList[0] + '&mallType=' + _this.params.mallType);\n        }\n      };\n    });\n    _defineProperty(_this, \"removeFunc\", function () {\n      var checkedList = _this.state.checkedList;\n      if (checkedList.length == 0) {\n        JsUtil.showMsgBox(_this, '请至少选中一项');\n        return;\n      }\n      var uri = \"/sp/pub/region/delete\";\n      if (_this.params.mallType == cnst.MALL_TYPE_G_B2C) uri = \"/sp/pub/global/delete\";\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {\n          _this.setState(_defineProperty({}, name, []));\n          _this.fetchSupplier({});\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(checkedList), succ, err);\n    });\n    _defineProperty(_this, \"createAddress\", function () {\n      var checkedList = _this.state.checkedList;\n      if (checkedList.length == 0) {\n        JsUtil.showMsgBox(_this, \"请至少选中一项\");\n      } else if (checkedList.length > 1) {\n        JsUtil.showMsgBox(_this, '只能选择一条记录');\n      }\n      JsUtil.go2Page(URI.LOGISTICS_ADDRESS_ENTITY + '?mode=' + cnst.SHOW_MODE_NEW + '&mallType=' + cnst.MALL_TYPE_R_B2C + '&orgId=' + checkedList[0]);\n    });\n    _defineProperty(_this, \"createVisit\", function () {\n      var checkedList = _this.state.checkedList;\n      if (checkedList.length == 0) {\n        JsUtil.showMsgBox(_this, \"请至少选中一项\");\n      } else if (checkedList.length > 1) {\n        JsUtil.showMsgBox(_this, '只能选择一条记录');\n      }\n      JsUtil.go2Page(URI.SUPPLIER_VISIT_ENTITY + '?mode=' + cnst.SHOW_MODE_NEW + '&supplierId=' + checkedList[0]);\n    });\n    _defineProperty(_this, \"approvePrepare\", function () {\n      var checkedList = _this.state.checkedList;\n      if (checkedList.length == 0) {\n        JsUtil.showMsgBox(_this, \"请至少选中一项\");\n      } else if (checkedList.length > 1) {\n        JsUtil.showMsgBox(_this, '只能选择一条记录');\n      } else {\n        _this.setState({\n          popupApprove: true\n        });\n      }\n    });\n    _defineProperty(_this, \"approve\", function () {\n      _this.approve0(true);\n    });\n    _defineProperty(_this, \"reject\", function () {\n      _this.approve0(false);\n    });\n    _defineProperty(_this, \"approve0\", function (pass) {\n      var remark = _this.state.remark;\n      if (!pass && !remark) {\n        JsUtil.showMsgBox(_this, '请填写备注');\n        return;\n      }\n      var checkedList = _this.state.checkedList;\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {\n          _this.setState(_defineProperty({}, name, []));\n          _this.fetchSupplier({});\n        }\n      };\n      var err = function err(result) {\n        JsUtil.showMsgBox(_this, '请求失败:' + result.message);\n      };\n      var uri = \"/sp/pub/region/approve/update\";\n      if (_this.params.mallType == cnst.MALL_TYPE_G_B2C) uri = \"/sp/pub/global/approve/update\";\n      JsUtil.asyncHttpPost(_this, uri, \"id=\" + checkedList[0] + '&pass=' + pass + '&remark=' + remark, succ, err, \"application/x-www-form-urlencoded\");\n      _this.setState({\n        remark: '',\n        popupApprove: false\n      });\n    });\n    _defineProperty(_this, \"getSupplierOptions\", function (records) {\n      var options = [];\n      records.map(function (item, indx) {\n        var desc = /*#__PURE__*/_jsxs(RowLayout, {\n          justifyContent: \"space-between\",\n          width: cnst.NUM_WIDTH_MAIN + 3,\n          children: [/*#__PURE__*/_jsx(TextLabel, {\n            children: item.legalRepresentative\n          }), /*#__PURE__*/_jsx(TextLabel, {\n            children: item.detailAddress\n          })]\n        });\n        options.push({\n          value: item.id,\n          label: item.supplierName,\n          desc: desc\n        });\n      });\n      return options;\n    });\n    _defineProperty(_this, \"onCheckBoxesAllChanged\", function (name, selectedValues) {\n      if (selectedValues.length == 0) {\n        _this.setState(_defineProperty({}, name, []));\n      } else {\n        _this.setState(_defineProperty({}, name, _this.checkedAllList));\n      }\n    });\n    _defineProperty(_this, \"onCascadeBoxChanged\", function (name, selectedValues) {\n      _this.setState(_defineProperty({}, name, selectedValues));\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onClose\", function (name) {\n      _this.setState(_defineProperty({}, name, false));\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    if (per.hasRole(per.authorities.OP_SALEMAN) && !per.hasRole(per.authorities.OP_ROOT)) {\n      _this.isSaleman = true;\n    }\n    _this.state = {\n      suppliers: [],\n      checkedList: [],\n      supplierName: \"\",\n      remark: '',\n      totalRecords: 0,\n      popupApprove: false,\n      messages: {}\n    };\n    return _this;\n  }\n  _inherits(SupplierList, _React$Component);\n  return _createClass(SupplierList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchSupplier({});\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n      var _this$state = this.state,\n        suppliers = _this$state.suppliers,\n        checkedList = _this$state.checkedList;\n      var options = this.getSupplierOptions(suppliers);\n      var topNavBarTitle = '供应商列表';\n      var commandLabel3 = '删除';\n      var command3 = this.removeFunc;\n      var commandLabel4 = this.currOrgType == cnst.ORG_TYPE_SP_G || this.currOrgType == cnst.ORG_TYPE_SP_R || this.currOrgType == cnst.ORG_TYPE_SP_B || this.currOrgType == cnst.ORG_TYPE_MB ? '编辑' : '';\n      var command4 = this.detailFunc(cnst.SHOW_MODE_EDIT);\n      var commandLabel5 = this.currOrgType == cnst.ORG_TYPE_HQ || this.currOrgType == cnst.ORG_TYPE_OP ? '审批' : '';\n      var command5 = this.approvePrepare;\n      if (this.isSaleman) {\n        commandLabel3 = '新建拜访';\n        command3 = this.createVisit;\n        commandLabel5 = '新建地址';\n        command5 = this.createAddress;\n      }\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel1: '全选',\n        bottomFunc1: this.onCheckBoxesAllChanged,\n        bottomLabel2: '明细',\n        bottomFunc2: this.detailFunc(cnst.SHOW_MODE_VIEW),\n        bottomLabel3: commandLabel3,\n        bottomFunc3: command3,\n        bottomLabel4: commandLabel4,\n        bottomFunc4: command4,\n        bottomLabel5: commandLabel5,\n        bottomFunc5: command5,\n        children: [/*#__PURE__*/_jsx(CascadeBox, {\n          name: \"checkedList\",\n          options: options,\n          value: checkedList,\n          onChange: this.onCascadeBoxChanged\n        }), /*#__PURE__*/_jsx(TaroModal, {\n          isOpened: this.state.popupApprove,\n          onClose: function onClose(e) {\n            return _this2.onClose('popupApprove', e);\n          },\n          onConfirm: this.approve,\n          onCancel: this.reject,\n          confirmText: \"\\u901A\\u8FC7\",\n          cancelText: \"\\u62D2\\u7EDD\",\n          children: /*#__PURE__*/_jsx(GeneralInput, {\n            name: 'remark',\n            label: this.labels.remark,\n            type: 'text',\n            value: this.state.remark,\n            error: this.errors.remark,\n            onChange: this.onInputChanged\n          })\n        })]\n      });\n    }\n  }]);\n}(React.Component);\nexport default SupplierList;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgsubject/page/supplier/SupplierList!./SupplierList.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgsubject/page/supplier/SupplierList', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}