{"version":3,"file":"pkgsubject/page/supplier/SupplierVisitEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgsubject/page/supplier/SupplierVisitEntity.tsx?9088","webpack://i_bizz_client/._src_pkgsubject_page_supplier_SupplierVisitEntity.tsx"],"sourcesContent":["import _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport React from 'react';\nimport validator from 'validator';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport BrView from 'tsx/view/BrView';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport ImagePicker from 'tsx/form/ImagePicker';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar SupplierVisitEntity = /*#__PURE__*/function (_React$Component) {\n  function SupplierVisitEntity(props) {\n    var _this;\n    _classCallCheck(this, SupplierVisitEntity);\n    _this = _callSuper(this, SupplierVisitEntity, [props]);\n    _defineProperty(_this, \"labels0\", {\n      intervieweeName: '被访者名称',\n      intervieweePhone: '被访者电话',\n      intervieweeWechatNo: '被访者微信',\n      intervieweeWechatQrcode: '被访者微信二维码',\n      supplierImage: '供应商大图',\n      intervieweeAudio: '拜访音频',\n      intervieweeVideo: '拜访视频',\n      remark: '备注'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"validateFields\", void 0);\n    _defineProperty(_this, \"validateForm\", void 0);\n    _defineProperty(_this, \"params\", void 0);\n    _defineProperty(_this, \"currOrgType\", JsUtil.getAppItem('currOrgType'));\n    _defineProperty(_this, \"showDetails\", function () {\n      var mode = _this.state.mode;\n      var id = _this.state.id;\n      var supplierId = _this.params.supplierId;\n      var uri = \"/sp/pub/visit/load/search?id=\".concat(id);\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        _this.setState({\n          disabled: true\n        });\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          var intervieweeWechatQrcodeFile = [];\n          intervieweeWechatQrcodeFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.intervieweeWechatQrcode\n          });\n          var supplierImageFile = [];\n          supplierImageFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.supplierImage\n          });\n          var intervieweeAudioFile = [];\n          intervieweeAudioFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.supplierImage\n          });\n          var intervieweeVideoFile = [];\n          intervieweeVideoFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.intervieweeVideo\n          });\n          _this.setState({\n            entity: entity,\n            intervieweeName: entity.intervieweeName,\n            intervieweePhone: entity.intervieweePhone,\n            intervieweeWechatNo: entity.intervieweeWechatNo,\n            remark: entity.remark,\n            intervieweeWechatQrcode: entity.intervieweeWechatQrcode,\n            intervieweeWechatQrcodeFile: intervieweeWechatQrcodeFile,\n            supplierImage: entity.supplierImage,\n            supplierImageFile: supplierImageFile,\n            intervieweeAudio: entity.intervieweeAudio,\n            intervieweeAudioFile: intervieweeAudioFile,\n            intervieweeVideo: entity.intervieweeVideo,\n            intervieweeVideoFile: intervieweeVideoFile\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, uri, succ, err);\n    });\n    _defineProperty(_this, \"submitFunc\", function () {\n      var entity = _this.state.entity;\n      var intervieweeName = _this.state.intervieweeName;\n      var intervieweePhone = _this.state.intervieweePhone;\n      var intervieweeWechatNo = _this.state.intervieweeWechatNo;\n      var remark = _this.state.remark;\n      var intervieweeWechatQrcode = _this.state.intervieweeWechatQrcode;\n      var supplierImage = _this.state.supplierImage;\n      var intervieweeAudio = _this.state.intervieweeAudio;\n      var intervieweeVideo = _this.state.intervieweeVideo;\n      var param = _objectSpread(_objectSpread({}, entity), {}, {\n        intervieweeName: intervieweeName,\n        intervieweePhone: intervieweePhone,\n        intervieweeWechatNo: intervieweeWechatNo,\n        remark: remark,\n        intervieweeWechatQrcode: intervieweeWechatQrcode,\n        supplierImage: supplierImage,\n        intervieweeAudio: intervieweeAudio,\n        intervieweeVideo: intervieweeVideo\n      });\n      var uri = '/sp/pub/visit/create';\n      if (_this.state.mode == cnst.SHOW_MODE_NEW) param.supplierId = _this.params.supplierId;else if (_this.state.mode == cnst.SHOW_MODE_EDIT) uri = '/sp/pub/visit/update';\n      var msgs = _this.validateForm(validator, _this.labels0, param);\n      if (msgs != '') {\n        JsUtil.showMsgBox(_this, msgs);\n        return;\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"imageFileChanged\", function (fieldName) {\n      return function (value, opType, idx) {\n        var fileName = fieldName + 'File';\n        if ('add' == opType) {\n          var succ = function succ(result) {\n            if (result.statusCode) result = JSON.parse(result.data);\n            if (JsUtil.handleMessage(_this, result)) {\n              _this.setState(_defineProperty({}, fieldName, result.body));\n            }\n          };\n          var err = function err(result) {\n            if (result.statusCode) result = JSON.parse(result.data);\n            JsUtil.handleMessage(_this, result);\n          };\n          JsUtil.uploadSingleFile(_this, value[0].file, succ, err);\n          var newValue = [];\n          value[1] ? newValue.push(value[1]) : newValue.push(value[0]);\n          _this.setState(_defineProperty({}, fileName, newValue));\n        } else if ('remove' == opType) {\n          _this.setState(_defineProperty({}, fileName, []));\n        }\n      };\n    });\n    _defineProperty(_this, \"goBack\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"editFunc\", function () {\n      JsUtil.go2Page(URI.SUPPLIER_VISIT_ENTITY + '?mode=' + cnst.SHOW_MODE_EDIT + '&id=' + _this.params.id);\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.state = {\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      id: _this.params.id || '',\n      entity: {},\n      intervieweeName: '',\n      intervieweePhone: '',\n      intervieweeWechatNo: '',\n      remark: '',\n      intervieweeWechatQrcode: '',\n      intervieweeWechatQrcodeFile: [],\n      supplierImage: '',\n      supplierImageFile: [],\n      intervieweeAudio: '',\n      intervieweeAudioFile: [],\n      intervieweeVedio: '',\n      intervieweeVedioFile: [],\n      errors: {\n        supplierImage: false,\n        intervieweeName: false,\n        intervieweeWechatNo: false,\n        intervieweeWechatQrcode: false,\n        intervieweePhone: false,\n        remark: ''\n      }\n    };\n    return _this;\n  }\n  _inherits(SupplierVisitEntity, _React$Component);\n  return _createClass(SupplierVisitEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      JsUtil.init(this, '/sp/pub/visit/init/search', 'supplierVisit').then(function (_ref) {\n        var validateFields = _ref.validateFields,\n          validateForm = _ref.validateForm;\n        _this2.validateFields = validateFields;\n        _this2.validateForm = validateForm;\n      });\n      if (cnst.SHOW_MODE_VIEW == this.state.mode || cnst.SHOW_MODE_EDIT == this.state.mode) {\n        this.showDetails();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n        mode = _this$state.mode,\n        supplierTypeOptions = _this$state.supplierTypeOptions,\n        supplierType = _this$state.supplierType;\n      var prevUrl = JsUtil.IMAGE_PREFIX;\n      var labelKey = 'label';\n      var valueKey = 'value';\n      var labelWidth = cnst.NUM_WIDTH_LABEL;\n      var valueWidth = cnst.NUM_WIDTH_VALUE;\n      var topNavBarTitle = this.params.mallType == cnst.MALL_TYPE_R_B2C ? '本地供应商' : this.params.mallType == cnst.MALL_TYPE_G_B2C ? '全国供应商' : '供应商';\n      var command1Label = '提交';\n      var command1 = this.submitFunc;\n      var command2Label = '';\n      var command2 = this.editFunc;\n      var disabled = false;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        command1Label = '关闭';\n        command1 = this.goBack;\n        //command2Label = '编辑';\n        disabled = true;\n      }\n      var setting = {\n        subkey: JsUtil.TENCENT_MAP_KEY,\n        skew: 0,\n        rotate: 0,\n        showLocation: false,\n        showScale: false,\n        layerStyle: 1,\n        enableZoom: true,\n        enableScroll: true,\n        enableRotate: false,\n        showCompass: false,\n        enable3D: false,\n        enableOverlooking: false,\n        enableSatellite: false,\n        enableTraffic: false\n      };\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel3: command1Label,\n        bottomFunc3: command1,\n        bottomLabel4: command2Label,\n        bottomFunc4: command2,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'intervieweeName',\n          label: '*' + this.labels.intervieweeName,\n          type: 'text',\n          value: this.state.intervieweeName,\n          error: this.state.errors.intervieweeName,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'intervieweePhone',\n          label: this.labels.intervieweePhone,\n          type: 'text',\n          value: this.state.intervieweePhone,\n          error: this.state.errors.intervieweePhone,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'intervieweeWechatNo',\n          label: this.labels.intervieweeWechatNo,\n          type: 'text',\n          value: this.state.intervieweeWechatNo,\n          error: this.state.errors.intervieweeWechatNo,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'remark',\n          label: this.labels.remark,\n          type: 'text',\n          value: this.state.remark,\n          error: this.state.errors.remark,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: this.labels.intervieweeWechatQrcode\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.intervieweeWechatQrcodeFile,\n          onChange: this.imageFileChanged('intervieweeWechatQrcode'),\n          count: 1,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: this.labels.supplierImage\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.supplierImageFile,\n          onChange: this.imageFileChanged('supplierImage'),\n          count: 1,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: this.labels.intervieweeAudio\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.intervieweeAudioFile,\n          onChange: this.imageFileChanged('intervieweeAudio'),\n          count: 1,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: this.labels.intervieweeVideo\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.intervieweeVideoFile,\n          onChange: this.imageFileChanged('intervieweeVideo'),\n          count: 1,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: cnst.NUM_HEIGHT_LINE,\n          backgroundColor: cnst.COLOR_BACKGROUND_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component);\nexport default SupplierVisitEntity;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgsubject/page/supplier/SupplierVisitEntity!./SupplierVisitEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgsubject/page/supplier/SupplierVisitEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}