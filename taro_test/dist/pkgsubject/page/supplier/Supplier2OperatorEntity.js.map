{"version":3,"file":"pkgsubject/page/supplier/Supplier2OperatorEntity.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AACA;AACA","sources":["webpack://i_bizz_client/./src/pkgsubject/page/supplier/Supplier2OperatorEntity.tsx?bfa2","webpack://i_bizz_client/._src_pkgsubject_page_supplier_Supplier2OperatorEntity.tsx","webpack://i_bizz_client/._node_modules_@babel_runtime_helpers_esm_readOnlyError.js"],"sourcesContent":["import _readOnlyError from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/readOnlyError.js\";\nimport _objectSpread from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _defineProperty from \"c:/taro/i_bizz_client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport React from 'react';\nimport validator from 'validator';\nimport JsUtil from 'tsx/common/JsUtil';\nimport cnst from 'tsx/common/Constant';\nimport URI from 'tsx/common/URI';\nimport HeadLayout from 'tsx/layout/HeadLayout';\nimport BrView from 'tsx/view/BrView';\nimport TextLabel from 'tsx/view/TextLabel';\nimport GeneralInput from 'tsx/form/GeneralInput';\nimport OperatorSelect from 'tsx/component/OperatorSelect';\nimport ImagePicker from 'tsx/form/ImagePicker';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Supplier2OperatorEntity = /*#__PURE__*/function (_React$Component) {\n  function Supplier2OperatorEntity(props) {\n    var _this;\n    _classCallCheck(this, Supplier2OperatorEntity);\n    _this = _callSuper(this, Supplier2OperatorEntity, [props]);\n    _defineProperty(_this, \"labels0\", {\n      supplierName: '店铺名称',\n      operatorId: '运营中心',\n      operatorName: '运营中心名称',\n      businessLicenseNo: '营业执照编码',\n      businessLicensePic: '营业执照(身份证)扫描件',\n      otherPic: '其它资料',\n      remark: '备注'\n    });\n    _defineProperty(_this, \"labels1\", _objectSpread({}, _this.labels0));\n    _defineProperty(_this, \"labels\", _objectSpread({}, _this.labels1));\n    _defineProperty(_this, \"validateFields\", void 0);\n    _defineProperty(_this, \"validateForm\", void 0);\n    _defineProperty(_this, \"opOptionType\", void 0);\n    _defineProperty(_this, \"setSupplierId\", function () {\n      var param = {};\n      var uri = \"/sp/pub/application/search\";\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          if (!result.body[0]) {\n            JsUtil.showMsgBox(_this, '请先新建供应商');\n            return;\n          }\n          var supplierId = result.body[0].id;\n          var supplierName = result.body[0].orgName;\n          _this.setState({\n            entity: {\n              supplierId: supplierId,\n              supplierName: supplierName\n            }\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"showDetails\", function () {\n      var mode = _this.state.mode;\n      var id = _this.state.id;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        _this.setState({\n          disabled: true\n        });\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result)) {\n          var entity = result.body;\n          var supplierId = entity.supplierId;\n          var supplierName = entity.supplierName;\n          var operatorId = entity.operatorId;\n          var operatorName = entity.operatorName;\n          var businessLicensePicFile = [];\n          businessLicensePicFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.businessLicensePic\n          });\n          var otherPicFile = [];\n          if (entity.otherPic) otherPicFile.push({\n            url: JsUtil.IMAGE_PREFIX + entity.otherPic\n          });\n          _this.setState({\n            entity: entity,\n            businessLicenseNo: entity.businessLicenseNo,\n            businessLicensePic: entity.businessLicensePic,\n            otherPic: entity.otherPic,\n            businessLicensePicFile: businessLicensePicFile,\n            otherPicFile: otherPicFile,\n            supplierId: supplierId,\n            supplierName: supplierName,\n            operatorId: operatorId,\n            operatorName: operatorName\n          });\n        }\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpGet(_this, \"/sp/pub/op/load/search?id=\".concat(id), succ, err);\n    });\n    _defineProperty(_this, \"submitFunc\", function () {\n      if (!_this.state.entity.supplierId) {\n        JsUtil.showMsgBox(_this, '请先新建供应商');\n        return;\n      }\n      var supplierId = _this.state.entity.supplierId;\n      var supplierName = _this.state.supplierName;\n      var operatorId = _this.state.operatorId;\n      var operatorName = _this.state.operatorName;\n      var businessLicenseNo = _this.state.businessLicenseNo;\n      var businessLicensePic = _this.state.businessLicensePic;\n      var otherPic = _this.state.otherPic;\n      var entity = _this.state.entity;\n      var preData = {};\n      if (_this.state.mode == cnst.SHOW_MODE_EDIT) preData = entity;\n      var param = _objectSpread(_objectSpread({}, entity), {}, {\n        businessLicenseNo: businessLicenseNo,\n        businessLicensePic: businessLicensePic,\n        otherPic: otherPic,\n        supplierId: supplierId,\n        supplierName: supplierName,\n        operatorId: operatorId,\n        operatorName: operatorName\n      });\n      var uri = '/sp/pub/op/create';\n      if (_this.state.mode == cnst.SHOW_MODE_EDIT) {\n        uri = '/sp/pub/op/update';\n      }\n      var msgs = _this.validateForm(validator, _this.labels0, param);\n      if (msgs != '') {\n        JsUtil.showMsgBox(_this, msgs);\n        return;\n      }\n      var succ = function succ(result) {\n        if (JsUtil.handleMessage(_this, result, true)) {}\n      };\n      var err = function err(result) {\n        JsUtil.handleMessage(_this, result, true);\n      };\n      JsUtil.asyncHttpPost(_this, uri, JSON.stringify(param), succ, err);\n    });\n    _defineProperty(_this, \"onInputChanged\", function (name, value) {\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState(_defineProperty({}, name, value));\n    });\n    _defineProperty(_this, \"onInputChanged2\", function (name, value) {\n      //name='entity.'+name\n\n      if (_this.state.mode != cnst.SHOW_MODE_LIST) _this.validateFields(_this, validator, name, value);\n      _this.setState({\n        'entity': _objectSpread(_objectSpread({}, _this.state.entity), {}, _defineProperty({}, name, value))\n      });\n    });\n    _defineProperty(_this, \"onBusinessLicensePicChanged\", function (newValue, opType, uriOrIdx) {\n      if ('add' == opType) {\n        console.log('uriOrIdx: ', uriOrIdx);\n        _this.setState({\n          businessLicensePic: uriOrIdx\n        });\n      } else if ('rm' == opType) {\n        _this.setState({\n          businessLicensePic: ''\n        });\n      }\n      _this.setState({\n        businessLicensePicFile: newValue\n      });\n    });\n    _defineProperty(_this, \"onOtherPicChanged\", function (newValue, opType, uriOrIdx) {\n      var otherPic = _this.state.otherPic;\n      if ('add' == opType) {\n        otherPic.push(uriOrIdx);\n        _this.setState({\n          otherPic: otherPic\n        });\n      } else if ('rm' == opType) {\n        otherPic.slice(1), _readOnlyError(\"otherPic\");\n        _this.setState({\n          otherPic: otherPic\n        });\n      }\n      _this.setState({\n        otherPicFile: newValue\n      });\n    });\n    _defineProperty(_this, \"goBack\", function () {\n      JsUtil.goBack();\n    });\n    _defineProperty(_this, \"editFunc\", function () {\n      JsUtil.go2Page(URI.SUPPLIER_SUPPLIER_ENTITY + '?mode=' + cnst.SHOW_MODE_EDIT + '&id=' + JsUtil.getAppItem('currOrgId'));\n    });\n    _defineProperty(_this, \"onClose\", function (name) {\n      _this.setState(_defineProperty({}, name, false));\n    });\n    _defineProperty(_this, \"onConfirm\", function () {\n      JsUtil.closeMsgBox(_this);\n    });\n    _this.params = JsUtil.getUrlParams(_this);\n    _this.opOptionType = cnst.OP_OPTION_TYPE_ALL;\n    _this.state = _defineProperty(_defineProperty(_defineProperty({\n      mode: _this.params.mode || cnst.SHOW_MODE_NEW,\n      id: _this.params.id || '',\n      entity: {\n        supplierId: _this.params.supplierId\n      },\n      supplierName: '',\n      operatorOptions: [],\n      operatorId: '',\n      operatorName: '',\n      otherPic: [],\n      otherPicFile: [],\n      businessLicensePicFile: [],\n      businessLicenseNo: '',\n      businessLicensePic: '',\n      regionId: ''\n    }, \"otherPic\", ''), \"messages\", {}), \"errors\", {\n      businessLicenseNo: false,\n      businessLicensePic: false,\n      otherPic: false,\n      remark: ''\n    });\n    return _this;\n  }\n  _inherits(Supplier2OperatorEntity, _React$Component);\n  return _createClass(Supplier2OperatorEntity, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      JsUtil.init(this, '/sp/pub/op/init/search', 'supplier2Operator').then(function (_ref) {\n        var validateFields = _ref.validateFields,\n          validateForm = _ref.validateForm;\n        _this2.validateFields = validateFields;\n        _this2.validateForm = validateForm;\n      });\n      if (cnst.SHOW_MODE_VIEW == this.state.mode || cnst.SHOW_MODE_EDIT == this.state.mode) {\n        this.showDetails();\n      } else {\n        this.setSupplierId();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n        mode = _this$state2.mode,\n        operatorOptions = _this$state2.operatorOptions,\n        operatorIdx = _this$state2.operatorIdx;\n      var prevUrl = JsUtil.IMAGE_PREFIX;\n      var topNavBarTitle = '供应商申请';\n      var command1Label = '提交';\n      var command1 = this.submitFunc;\n      var command2Label = '';\n      var command2 = this.editFunc;\n      var labelWidth = cnst.NUM_WIDTH_LABEL;\n      var valueWidth = cnst.NUM_WIDTH_VALUE;\n      var disabled = false;\n      if (mode == cnst.SHOW_MODE_VIEW) {\n        command1Label = '关闭';\n        command1 = this.goBack;\n        command2Label = '编辑';\n        disabled = true;\n      }\n      return /*#__PURE__*/_jsxs(HeadLayout, {\n        that: this,\n        topNavBarTitle: topNavBarTitle,\n        bottomLabel3: command1Label,\n        bottomFunc3: command1,\n        bottomLabel4: command2Label,\n        bottomFunc4: command2,\n        children: [/*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(OperatorSelect, {\n          mode: mode,\n          optionType: this.opOptionType,\n          checkedId: '',\n          that: this\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'supplierName',\n          label: '*' + this.labels.supplierName,\n          type: 'text',\n          value: this.state.supplierName,\n          error: this.state.errors.supplierName,\n          onChange: this.onInputChanged,\n          disabled: disabled\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'businessLicenseNo',\n          label: '*' + this.labels.businessLicenseNo,\n          type: 'text',\n          value: this.state.businessLicenseNo,\n          error: this.state.errors.businessLicenseNo,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: '*' + this.labels.businessLicensePic\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.businessLicensePicFile,\n          onChange: this.onBusinessLicensePicChanged,\n          count: 1,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(TextLabel, {\n          children: this.labels.otherPic\n        }), /*#__PURE__*/_jsx(ImagePicker, {\n          that: this,\n          files: this.state.otherPicFile,\n          onChange: this.onOtherPicChanged,\n          count: 10,\n          category: cnst.BIZZ_CAT_SUBJECT,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        }), /*#__PURE__*/_jsx(GeneralInput, {\n          name: 'remark',\n          label: this.labels.remark,\n          type: 'text',\n          value: this.state.remark,\n          error: this.state.errors.remark,\n          onChange: this.onInputChanged,\n          disabled: disabled,\n          labelWidth: labelWidth,\n          valueWidth: valueWidth\n        }), /*#__PURE__*/_jsx(BrView, {\n          height: 10,\n          backgroundColor: cnst.COLOR_BACKGROUND_TRANS_WHITE\n        })]\n      });\n    }\n  }]);\n}(React.Component);\nexport default Supplier2OperatorEntity;","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pkgsubject/page/supplier/Supplier2OperatorEntity!./Supplier2OperatorEntity.tsx\"\nvar config = {};\n\n\nvar inst = Page(createPageConfig(component, 'pkgsubject/page/supplier/Supplier2OperatorEntity', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n","function _readOnlyError(r) {\n  throw new TypeError('\"' + r + '\" is read-only');\n}\nexport { _readOnlyError as default };"],"names":[],"sourceRoot":""}